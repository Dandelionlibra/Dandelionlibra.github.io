<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Note on YuChen</title><link>https://Dandelionlibra.github.io/categories/note/</link><description>Recent content in Note on YuChen</description><generator>Hugo -- gohugo.io</generator><language>zh-Hant-TW</language><lastBuildDate>Wed, 06 Aug 2025 09:03:00 +0800</lastBuildDate><atom:link href="https://Dandelionlibra.github.io/categories/note/index.xml" rel="self" type="application/rss+xml"/><item><title>LightRAG Server æª”æ¡ˆå„²å­˜åŸºæœ¬ä»‹ç´¹</title><link>https://Dandelionlibra.github.io/post/note/lightrag-json-db/</link><pubDate>Wed, 06 Aug 2025 09:03:00 +0800</pubDate><guid>https://Dandelionlibra.github.io/post/note/lightrag-json-db/</guid><description>&lt;h1 id="lightrag-api-server-æ•™å­¸å¿«é€Ÿä¸Šæ‰‹æŒ‡å—"&gt;LightRAG API Server æ•™å­¸ï¼šå¿«é€Ÿä¸Šæ‰‹æŒ‡å—
&lt;/h1&gt;&lt;p&gt;&lt;a class="link" href="https://github.com/HKUDS/LightRAG" target="_blank" rel="noopener"
&gt;LightRAG&lt;/a&gt; æ˜¯ä¸€å€‹è¼•é‡ç´šã€æ¨¡çµ„åŒ–çš„ RAGï¼ˆæª¢ç´¢å¢å¼·ç”Ÿæˆï¼‰æ¡†æ¶ï¼Œæ—¨åœ¨ç°¡åŒ– RAG æ‡‰ç”¨çš„é–‹ç™¼èˆ‡éƒ¨ç½²ã€‚å…¶å…§å»ºçš„ API Server éµå¾ª OpenAI API æ¨™æº–ï¼Œä¸¦æä¾›ä¸€å¥—å®Œæ•´çš„ Web UI API ä¾†ç®¡ç†æ–‡ä»¶èˆ‡çŸ¥è­˜åœ–è­œï¼Œè®“é–‹ç™¼è€…èƒ½è¼•æ˜“åœ°å°‡è‡ªè¨‚çš„ RAG æµç¨‹å°è£æˆæœå‹™ï¼Œä¸¦èˆ‡ç¾æœ‰ç”Ÿæ…‹ç³»ç„¡ç¸«æ¥è»Œã€‚æœ¬æ–‡å°‡å¼•å°åˆå­¸è€…å®Œæˆå¾ç’°å¢ƒè¨­å®šåˆ° API å‘¼å«çš„å®Œæ•´æµç¨‹ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id="lightrag-æ”¯æ´çš„å„²å­˜é¡å‹"&gt;LightRAG æ”¯æ´çš„å„²å­˜é¡å‹
&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;KV_STORAGEï¼šllm å›æ‡‰å¿«å–ã€æ–‡å­—å€å¡Šã€æ–‡ä»¶è¨Šæ¯&lt;/li&gt;
&lt;li&gt;VECTOR_STORAGEï¼šå¯¦é«”å‘é‡ã€é—œä¿‚å‘é‡ã€å€å¡Šå‘é‡&lt;/li&gt;
&lt;li&gt;GRAPH_STORAGEï¼šå¯¦é«”é—œä¿‚åœ–&lt;/li&gt;
&lt;li&gt;DOC_STATUS_STORAGEï¼šæ–‡æª”ç´¢å¼•ç‹€æ…‹&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="1-kv_store_doc_statusjson"&gt;1. kv_store_doc_status.json
&lt;/h2&gt;&lt;p&gt;åŠŸèƒ½ï¼šç´€éŒ„æ¯ä»½æ–‡ä»¶åœ¨çŸ¥è­˜åº«ä¸­çš„è™•ç†ç‹€æ…‹èˆ‡ç›¸é—œè³‡è¨Šã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä¸»è¦æ¬„ä½&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;__id__&lt;/code&gt;ï¼šæ–‡ä»¶çš„å”¯ä¸€è­˜åˆ¥ç¢¼ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;file_path&lt;/code&gt;ï¼šåŸå§‹æ–‡ä»¶æª”åæˆ–è·¯å¾‘ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;status&lt;/code&gt;ï¼šè™•ç†ç‹€æ…‹ï¼ˆå¦‚ï¼šprocessed, pending, errorï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;updated_at&lt;/code&gt;ï¼šæœ€å¾Œæ›´æ–°æ™‚é–“ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;ç”¨é€”&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç›£æ§æ–‡ä»¶æ˜¯å¦å·²å®Œæˆåˆ‡å‰²ã€åµŒå…¥èˆ‡å­˜å…¥å‘é‡è³‡æ–™åº«ã€‚&lt;/li&gt;
&lt;li&gt;æ–¹ä¾¿è¿½è¹¤èˆ‡é™¤éŒ¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id="2-kv_store_full_docsjson"&gt;2. kv_store_full_docs.json
&lt;/h2&gt;&lt;p&gt;åŠŸèƒ½ï¼šå„²å­˜å®Œæ•´çš„åŸå§‹æ–‡æª”ï¼Œä½œç‚ºèªç¾©æª¢ç´¢çš„ä¾†æºã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä¸»è¦æ¬„ä½&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;__id__&lt;/code&gt;ï¼šæ–‡ä»¶å”¯ä¸€ IDã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;file_path&lt;/code&gt;ï¼šæª”æ¡ˆä¾†æºè·¯å¾‘ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;content&lt;/code&gt;ï¼šå®Œæ•´æ–‡ä»¶çš„æ–‡å­—å…§å®¹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;metadata&lt;/code&gt;ï¼šé™„å±¬è³‡è¨Šï¼ˆå¦‚æ¨™é¡Œã€ä½œè€…ã€åˆ†é¡ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;ç”¨é€”&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¿ç•™å®Œæ•´èªå¢ƒï¼Œä¾¿æ–¼ LLM åœ¨å›ç­”æ™‚å›æº¯å…¨æ–‡ã€‚&lt;/li&gt;
&lt;li&gt;æä¾›ã€Œéåˆ†å¡Šã€çš„å…¨æ–‡æª¢ç´¢ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id="3-kv_store_llm_response_cachejson"&gt;3. kv_store_llm_response_cache.json
&lt;/h2&gt;&lt;p&gt;åŠŸèƒ½ï¼šä½œç‚º LLM æŸ¥è©¢çµæœçš„å¿«å–ï¼Œé¿å…é‡è¤‡è¨ˆç®—ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä¸»è¦æ¬„ä½&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;query&lt;/code&gt;ï¼šä½¿ç”¨è€…è¼¸å…¥çš„æŸ¥è©¢å­—ä¸²ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;response&lt;/code&gt;ï¼šLLM ç”Ÿæˆçš„å›ç­”ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;timestamp&lt;/code&gt;ï¼šå¿«å–ç”Ÿæˆæ™‚é–“ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;hit_count&lt;/code&gt;ï¼šè©²æŸ¥è©¢è¢«é‡è¤‡ä½¿ç”¨çš„æ¬¡æ•¸ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;ç”¨é€”&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æå‡ç³»çµ±æ•ˆèƒ½ï¼Œæ¸›å°‘æ¨¡å‹é‡è¤‡æ¨ç†ã€‚&lt;/li&gt;
&lt;li&gt;å…è¨±åˆ†æç†±é–€æŸ¥è©¢ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id="4-kv_store_text_chunksjson"&gt;4. kv_store_text_chunks.json
&lt;/h2&gt;&lt;p&gt;åŠŸèƒ½ï¼šå„²å­˜å°‡æ–‡ä»¶åˆ‡å‰²å¾Œçš„å°ç‰‡æ®µï¼ˆchunksï¼‰ï¼Œæ–¹ä¾¿å‘é‡æª¢ç´¢ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä¸»è¦æ¬„ä½&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;__id__&lt;/code&gt;ï¼šæ–‡æœ¬ç‰‡æ®µ IDã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;file_path&lt;/code&gt;ï¼šä¾†æºæ–‡ä»¶åç¨±ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;chunk_index&lt;/code&gt;ï¼šç‰‡æ®µé †åºè™Ÿã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;content&lt;/code&gt;ï¼šç‰‡æ®µå…§å®¹æ–‡å­—ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;embedding_vector&lt;/code&gt;ï¼ˆå¯é¸ï¼‰ï¼šå°æ‡‰çš„å‘é‡åµŒå…¥ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;ç”¨é€”&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ”¯æ´èªæ„æª¢ç´¢ï¼ˆRAG: Retrieval-Augmented Generationï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;æ¯å€‹ chunk å°æ‡‰ä¸€çµ„ embeddingï¼Œåˆ©æ–¼è¿‘ä¼¼æœå°‹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å­˜æœ‰ token æ•¸ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id="vdb_chunksjson"&gt;vdb_chunks.json
&lt;/h2&gt;&lt;p&gt;åŠŸèƒ½ï¼šå„²å­˜ç¶“åµŒå…¥è™•ç†çš„æ–‡æœ¬å‘é‡ï¼ˆVector DB æ ¸å¿ƒï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä¸»è¦æ¬„ä½&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;__id__&lt;/code&gt;ï¼šchunk çš„å”¯ä¸€è­˜åˆ¥ç¢¼ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;embedding_dim&lt;/code&gt;ï¼šå‘é‡ç¶­åº¦ï¼ˆå¦‚ 1024ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;embedding_vector&lt;/code&gt;ï¼šåµŒå…¥å‘é‡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;content&lt;/code&gt;ï¼šå°æ‡‰æ–‡æœ¬ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;source_id&lt;/code&gt;ï¼šä¾†æº chunk çš„ IDã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;ç”¨é€”&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æä¾›é«˜æ•ˆç›¸ä¼¼åº¦æœå°‹ã€‚&lt;/li&gt;
&lt;li&gt;æ˜¯ RAG ç³»çµ±çš„æ ¸å¿ƒæª¢ç´¢è³‡æ–™ä¾†æºã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id="vdb_entitiesjson"&gt;vdb_entities.json
&lt;/h2&gt;&lt;p&gt;åŠŸèƒ½ï¼šå„²å­˜å¾æ–‡æœ¬ä¸­æŠ½å–çš„å‘½åå¯¦é«”èˆ‡ç›¸é—œæè¿°ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä¸»è¦æ¬„ä½&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;__id__&lt;/code&gt;ï¼šå¯¦é«” IDã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;entity_name&lt;/code&gt;ï¼šå¯¦é«”åç¨±ï¼ˆå¦‚ã€Œæ—è‡´è¿œã€ã€Œé˜¿å¢¨ã€ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;content&lt;/code&gt;ï¼šå¯¦é«”çš„æè¿°æˆ–å®šç¾©ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;file_path&lt;/code&gt;ï¼šä¾†æºæª”æ¡ˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;source_id&lt;/code&gt;ï¼šå°æ‡‰æ–‡æœ¬ç‰‡æ®µ IDã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;__created_at__&lt;/code&gt;ï¼šå»ºç«‹æ™‚é–“æˆ³ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;embedding_dim&lt;/code&gt;ï¼šåµŒå…¥å‘é‡ç¶­åº¦ï¼ˆå¦‚ 1024ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;ç‰¹è‰²&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¸€å€‹å¯¦é«”å¯èƒ½ä¾†è‡ªå¤šå€‹æ–‡æœ¬ç‰‡æ®µï¼Œç”¨ &lt;!-- raw HTML omitted --&gt; åˆ†éš”ã€‚&lt;/li&gt;
&lt;li&gt;å¯æ”¯æ´å¤šèªè¨€æˆ–å¤šç‰ˆæœ¬ï¼ˆå¦‚ çŸ¥ä¸€ä¹¦å±‹ vs çŸ¥ä¸€æ›¸å±‹ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;ç”¨é€”&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç‚ºçŸ¥è­˜åœ–è­œä¸­çš„ç¯€é»ï¼ˆentitiesï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;æ”¯æ´èªç¾©é—œè¯æª¢ç´¢èˆ‡ä¸Šä¸‹æ–‡è£œå…¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id="vdb_relationshipsjson"&gt;vdb_relationships.json
&lt;/h2&gt;&lt;p&gt;åŠŸèƒ½ï¼šå„²å­˜å¯¦é«”ä¹‹é–“çš„èªç¾©é—œä¿‚ï¼Œå½¢æˆçŸ¥è­˜åœ–è­œ (Knowledge Graph)ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä¸»è¦æ¬„ä½&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;__id__&lt;/code&gt;ï¼šé—œä¿‚ IDã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;src_id&lt;/code&gt;ï¼šé—œä¿‚çš„èµ·å§‹å¯¦é«”åç¨±ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;tgt_id&lt;/code&gt;ï¼šé—œä¿‚çš„ç›®æ¨™å¯¦é«”åç¨±ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;content&lt;/code&gt;ï¼šé—œä¿‚çš„æè¿°èˆ‡é¡åˆ¥ï¼ˆå¯èƒ½åŒ…å«å¤šç¨®èªæ„æ¨™ç±¤ï¼Œå¦‚ companionship, ownershipï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;file_path&lt;/code&gt;ï¼šä¾†æºæ–‡ä»¶ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;source_id&lt;/code&gt;ï¼šå°æ‡‰çš„æ–‡æœ¬ chunkã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;__created_at__&lt;/code&gt;ï¼šå»ºç«‹æ™‚é–“ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;ç”¨é€”&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ”¯æ´ã€Œèªç¾©åœ–è­œæª¢ç´¢ã€ï¼Œä¾‹å¦‚ï¼š&lt;br&gt;
å•ã€Œé˜¿å¢¨å’Œæ—è‡´è¿œçš„é—œä¿‚ï¼Ÿã€ â†’ æª¢ç´¢ companionship èˆ‡ mysterious connectionã€‚&lt;/li&gt;
&lt;li&gt;æä¾›çµæ§‹åŒ–çš„èªæ„æ¨ç†ï¼Œè£œå¼·å‘é‡æª¢ç´¢ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id="4-ç¸½çµ"&gt;4. ç¸½çµ
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;kv_store* ç³»åˆ— â†’ åå‘æ–‡ä»¶èˆ‡ç‰‡æ®µçš„ç®¡ç†ã€ç‹€æ…‹èˆ‡å¿«å–ã€‚&lt;/li&gt;
&lt;li&gt;vdb* ç³»åˆ— â†’ åå‘èªç¾©å±¤é¢çš„çŸ¥è­˜åœ–è­œèˆ‡å‘é‡æª¢ç´¢ã€‚&lt;/li&gt;
&lt;li&gt;entities èˆ‡ relationships â†’ æ§‹æˆçŸ¥è­˜åœ–è­œ (Knowledge Graph)ã€‚&lt;/li&gt;
&lt;li&gt;chunks èˆ‡ embeddings â†’ æ§‹æˆèªæ„æª¢ç´¢çš„åŸºç¤ã€‚&lt;/li&gt;
&lt;/ul&gt;</description></item><item><title>LightRAG API Server æ•™å­¸ï¼šå¿«é€Ÿä¸Šæ‰‹æŒ‡å—</title><link>https://Dandelionlibra.github.io/post/note/lightrag-api-server-tutorial/</link><pubDate>Fri, 01 Aug 2025 06:00:00 +0800</pubDate><guid>https://Dandelionlibra.github.io/post/note/lightrag-api-server-tutorial/</guid><description>&lt;h1 id="lightrag-api-server-æ•™å­¸å¿«é€Ÿä¸Šæ‰‹æŒ‡å—"&gt;LightRAG API Server æ•™å­¸ï¼šå¿«é€Ÿä¸Šæ‰‹æŒ‡å—
&lt;/h1&gt;&lt;p&gt;&lt;a class="link" href="https://github.com/HKUDS/LightRAG" target="_blank" rel="noopener"
&gt;LightRAG&lt;/a&gt; æ˜¯ä¸€å€‹è¼•é‡ç´šã€æ¨¡çµ„åŒ–çš„ RAGï¼ˆæª¢ç´¢å¢å¼·ç”Ÿæˆï¼‰æ¡†æ¶ï¼Œæ—¨åœ¨ç°¡åŒ– RAG æ‡‰ç”¨çš„é–‹ç™¼èˆ‡éƒ¨ç½²ã€‚å…¶å…§å»ºçš„ API Server éµå¾ª OpenAI API æ¨™æº–ï¼Œä¸¦æä¾›ä¸€å¥—å®Œæ•´çš„ Web UI API ä¾†ç®¡ç†æ–‡ä»¶èˆ‡çŸ¥è­˜åœ–è­œï¼Œè®“é–‹ç™¼è€…èƒ½è¼•æ˜“åœ°å°‡è‡ªè¨‚çš„ RAG æµç¨‹å°è£æˆæœå‹™ï¼Œä¸¦èˆ‡ç¾æœ‰ç”Ÿæ…‹ç³»ç„¡ç¸«æ¥è»Œã€‚æœ¬æ–‡å°‡å¼•å°åˆå­¸è€…å®Œæˆå¾ç’°å¢ƒè¨­å®šåˆ° API å‘¼å«çš„å®Œæ•´æµç¨‹ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id="1-å®‰è£èˆ‡ç’°å¢ƒè¨­å®š"&gt;1. å®‰è£èˆ‡ç’°å¢ƒè¨­å®š
&lt;/h2&gt;&lt;h3 id="11-å®‰è£-lightrag"&gt;1.1. å®‰è£ LightRAG
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;install from PyPl&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;pip install &lt;span style="color:#e6db74"&gt;&amp;#34;lightrag-hku[api]&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;Installation from Source&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;# 1. Clone the repository&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;git clone https://github.com/HKUDS/LightRAG.git
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;cd LightRAG
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;# 2. create a Python virtual environment if necessary&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;# 3. Install in editable mode with API support&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;pip install -e &lt;span style="color:#e6db74"&gt;&amp;#34;.[api]&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;# 4. ä¿®æ”¹ç¯„ä¾‹ç’°å¢ƒæ–‡ä»¶&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;cp env.example .env
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;# 5. å•Ÿå‹• API Server&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;lightrag-server
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id="12-ç’°å¢ƒæ–‡ä»¶è¨­å®š"&gt;1.2. ç’°å¢ƒæ–‡ä»¶è¨­å®š
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;OpenAI LLM + Ollama Embedding:&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;LLM_BINDING=openai
LLM_MODEL=gpt-4o
LLM_BINDING_HOST=https://api.openai.com/v1
LLM_BINDING_API_KEY=your_api_key
EMBEDDING_BINDING=ollama
EMBEDDING_BINDING_HOST=http://localhost:11434
EMBEDDING_MODEL=bge-m3:latest
EMBEDDING_DIM=1024
# EMBEDDING_BINDING_API_KEY=your_api_key
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;Ollama LLM + Ollama Embedding:&lt;/li&gt;
&lt;/ul&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;LLM_BINDING=ollama
LLM_MODEL=mistral-nemo:latest
LLM_BINDING_HOST=http://localhost:11434
# LLM_BINDING_API_KEY=your_api_key
### Ollama Server context length (Must be larger than MAX_TOTAL_TOKENS+2000)
OLLAMA_LLM_NUM_CTX=16384
EMBEDDING_BINDING=ollama
EMBEDDING_BINDING_HOST=http://localhost:11434
EMBEDDING_MODEL=bge-m3:latest
EMBEDDING_DIM=1024
# EMBEDDING_BINDING_API_KEY=your_api_key
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;å…¶ä»–ç’°å¢ƒè¨­å®šåƒæ•¸ï¼š
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;--host&lt;/code&gt;ï¼šä¼ºæœå™¨ç›£è½ä½å€ï¼ˆé è¨­ï¼š0.0.0.0ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;code&gt;--port&lt;/code&gt;ï¼šä¼ºæœå™¨ç›£è½é€£æ¥åŸ ï¼ˆé è¨­ï¼š9621ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;code&gt;--timeout&lt;/code&gt;ï¼šLLM è«‹æ±‚é€¾æ™‚ï¼ˆé è¨­å€¼ï¼š150 ç§’ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;code&gt;--log-level&lt;/code&gt;ï¼šæ—¥èªŒç­‰ç´šï¼ˆé è¨­ï¼šINFOï¼‰&lt;/li&gt;
&lt;li&gt;&lt;code&gt;--working-dir&lt;/code&gt;ï¼šè³‡æ–™åº«æŒä¹…ç›®éŒ„ï¼ˆé è¨­ï¼š./rag_storageï¼‰&lt;/li&gt;
&lt;li&gt;&lt;code&gt;--input-dir&lt;/code&gt;ï¼šä¸Šå‚³æª”æ¡ˆçš„ç›®éŒ„ï¼ˆé è¨­å€¼ï¼š./inputsï¼‰&lt;/li&gt;
&lt;li&gt;&lt;code&gt;--workspace&lt;/code&gt;ï¼šå·¥ä½œå€åç¨±ï¼Œç”¨æ–¼é‚è¼¯éš”é›¢å¤šå€‹ LightRAG å¯¦ä¾‹ä¹‹é–“çš„è³‡æ–™ï¼ˆé è¨­ï¼šç©ºï¼‰ï¼ŒåŠæ‰€ä»¥å·¥ä½œå…±ç”¨åŒä¸€å€‹è³‡æ–™ç›®éŒ„&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="13-ä½¿ç”¨-docker-å•Ÿå‹•-lightrag-ä¼ºæœå™¨"&gt;1.3. ä½¿ç”¨ Docker å•Ÿå‹• LightRAG ä¼ºæœå™¨
&lt;/h3&gt;&lt;p&gt;å»ºç«‹åç‚º &lt;code&gt;docker compose.yml&lt;/code&gt; çš„æª”æ¡ˆï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;services:
lightrag:
container_name: lightrag
image: ghcr.io/hkuds/lightrag:latest
ports:
- &amp;#34;${PORT:-9621}:9621&amp;#34;
volumes:
- ./data/rag_storage:/app/data/rag_storage
- ./data/inputs:/app/data/inputs
- ./config.ini:/app/config.ini
- ./.env:/app/.env
env_file:
- .env
restart: unless-stopped
extra_hosts:
- &amp;#34;host.docker.internal:host-gateway&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å•Ÿå‹• LightRAG ä¼ºæœå™¨ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;docker compose up
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;# If you want the program to run in the background after startup, add the -d parameter at the end of the command.&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;h2 id="2-å•Ÿå‹•-api-server"&gt;2. å•Ÿå‹• API Server
&lt;/h2&gt;&lt;p&gt;LightRAG ä½¿ç”¨ä¸€å€‹ YAML æª”æ¡ˆä¾†è¨­å®š API Serverï¼ŒåŒ…å«ç«¯å£ã€API è·¯å¾‘ä»¥åŠè¦è¼‰å…¥çš„æ¨¡å‹ã€‚å°ˆæ¡ˆå…§å·²æä¾›ä¸€å€‹ç¯„ä¾‹è¨­å®šæª” &lt;code&gt;lightrag_webui/config.yaml&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;é€²å…¥å®¹å™¨å¾Œä½¿ç”¨ä»¥ä¸‹æŒ‡ä»¤å•Ÿå‹•ä¼ºæœå™¨ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;lightrag-server
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Server æˆåŠŸå•Ÿå‹•å¾Œï¼Œæ‚¨æœƒçœ‹åˆ°é¡ä¼¼ä»¥ä¸‹çš„è¼¸å‡ºï¼Œä»£è¡¨ä¼ºæœå™¨æ­£åœ¨ &lt;code&gt;localhost:9621&lt;/code&gt; ä¸Šé‹è¡Œï¼š&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt; â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ LightRAG Server v1.4.4/0189 â•‘
â•‘ Fast, Lightweight RAG Server Implementation â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“¡ Server Configuration:
â”œâ”€ Host: 0.0.0.0
â”œâ”€ Port: 9621
â”œâ”€ Workers: 1
â”œâ”€ CORS Origins: *
â”œâ”€ SSL Enabled: False
â”œâ”€ Ollama Emulating Model: lightrag:latest
â”œâ”€ Log Level: INFO
â”œâ”€ Verbose Debug: False
â”œâ”€ History Turns: 0
â”œâ”€ API Key: Not Set
â””â”€ JWT Auth: Disabled
&lt;/code&gt;&lt;/pre&gt;&lt;hr&gt;
&lt;h2 id="3-api-ç«¯é»è©³è§£"&gt;3. API ç«¯é»è©³è§£
&lt;/h2&gt;&lt;p&gt;&lt;code&gt;-X&lt;/code&gt;: æŒ‡å®š HTTP æ–¹æ³•&lt;br&gt;
&lt;code&gt;-H&lt;/code&gt;: åŠ å…¥ HTTP æ¨™é ­&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ex. &lt;code&gt;-H &amp;quot;Content-Type: application/json&amp;quot;&lt;/code&gt; ç”¨æ–¼å‘ŠçŸ¥ä¼ºæœå™¨æ­¤æ¬¡è«‹æ±‚çš„è³‡æ–™æ ¼å¼æ˜¯ JSONã€‚&lt;br&gt;
å¯å¤šæ¬¡ä½¿ç”¨ &lt;code&gt;-H&lt;/code&gt; åŠ æ¨™é ­ã€‚&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;&lt;code&gt;-d&lt;/code&gt;: å‚³é€è«‹æ±‚è³‡æ–™ï¼Œå¸¸æ­é… &lt;code&gt;POST&lt;/code&gt;,&lt;code&gt;PUT&lt;/code&gt; ä½¿ç”¨ï¼Œç•¶æŒ‡å®š &lt;code&gt;Content-Type: application/json&lt;/code&gt; æ™‚ï¼ŒæœƒæŠŠå…§å®¹ç•¶ JSON å‚³é€ã€‚&lt;br&gt;
&lt;code&gt;-v&lt;/code&gt;: verbose æ¨¡å¼ï¼Œé¡¯ç¤ºå®Œæ•´è«‹æ±‚èˆ‡å›æ‡‰éç¨‹ï¼Œä¸»è¦ç”¨æ–¼é™¤éŒ¯ã€‚&lt;br&gt;
&lt;code&gt;-o &amp;lt;file&amp;gt;&lt;/code&gt;: è¼¸å‡ºåˆ°æª”æ¡ˆä¸­ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;ç²å–æ–‡ä»¶ api æ•™å­¸&lt;/strong&gt;&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code&gt;lightrag-server --help
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æˆ–åœ¨é€£ä¸Š server å¾Œé–‹å•Ÿ: http://localhost:9621/redoc#tag/documents/operation&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="31-documents"&gt;3.1. Documents
&lt;/h3&gt;&lt;hr&gt;
&lt;h4 id="311-scan-for-new-documents"&gt;3.1.1. Scan For New Documents
&lt;/h4&gt;&lt;p&gt;&lt;code&gt;POST&lt;/code&gt;: &lt;code&gt;/documents/scan&lt;/code&gt;&lt;br&gt;
å•Ÿå‹•èƒŒæ™¯æƒæï¼Œå»æª¢æŸ¥è¼¸å…¥ç›®éŒ„ä¸­æ˜¯å¦æœ‰æ–°çš„æ–‡ä»¶ï¼Œè‹¥æœ‰å‰‡è®€å–é€™äº›æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å›å‚³å…§å®¹&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;status&lt;/code&gt;(required): Status of the scanning operation.&lt;br&gt;
value: &lt;code&gt;scanning_started&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;message&lt;/code&gt;: Additional details about the scanning operation.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;curl -X POST &lt;span style="color:#e6db74"&gt;&amp;#34;http://localhost:9621/documents/scan&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;h4 id="312-upload-to-input-dir"&gt;3.1.2. Upload To Input Dir
&lt;/h4&gt;&lt;p&gt;&lt;code&gt;POST&lt;/code&gt;: &lt;code&gt;/documents/upload&lt;/code&gt;&lt;br&gt;
å°‡æª”æ¡ˆä¸Šå‚³åˆ°æŒ‡å®šçš„ç›®éŒ„ï¼Œå†å°å…¶é€²è¡Œç´¢å¼•ï¼Œä»¥ä¾¿æª¢ç´¢ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å‚³å…¥åƒæ•¸&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;file&lt;/code&gt;(required): è¦ä¸Šå‚³çš„æª”æ¡ˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;api_key_header_value&lt;/code&gt;: æœ‰äº›ä¼ºæœå™¨å¯èƒ½éœ€è¦ API Key åšèº«ä»½é©—è­‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;å›å‚³å…§å®¹&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;status&lt;/code&gt;(required): Status of the uploadding operation.&lt;br&gt;
Enum: &lt;code&gt;success&lt;/code&gt;ã€&lt;code&gt;duplicated&lt;/code&gt;ã€&lt;code&gt;partial_success&lt;/code&gt;ã€&lt;code&gt;failure&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;message&lt;/code&gt;(required): Message describing the operation result.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;â€»&lt;code&gt;-F &amp;quot;file=@æª”æ¡ˆè·¯å¾‘&amp;quot;&lt;/code&gt; ç”¨æ–¼å‚³ multipart/form-dataã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;curl -X POST &lt;span style="color:#e6db74"&gt;&amp;#34;http://localhost:9621/documents/upload&amp;#34;&lt;/span&gt; &lt;span style="color:#ae81ff"&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ae81ff"&gt;&lt;/span&gt; -F &lt;span style="color:#e6db74"&gt;&amp;#34;file=@./../prince_docs/little_prince_1.txt&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;hr&gt;
&lt;hr&gt;
&lt;h3 id="32-query"&gt;3.2. Query
&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;mode: Literal[&amp;quot;local&amp;quot;, &amp;quot;global&amp;quot;, &amp;quot;hybrid&amp;quot;, &amp;quot;naive&amp;quot;, &amp;quot;mix&amp;quot;, &amp;quot;bypass&amp;quot;] = &amp;quot;global&amp;quot;
&amp;quot;&amp;quot;&amp;quot;Specifies the retrieval mode:
- &amp;quot;local&amp;quot;: Focuses on context-dependent information.
- &amp;quot;global&amp;quot;: Utilizes global knowledge.
- &amp;quot;hybrid&amp;quot;: Combines local and global retrieval methods.
- &amp;quot;naive&amp;quot;: Performs a basic search without advanced techniques.
- &amp;quot;mix&amp;quot;: Integrates knowledge graph and vector retrieval.
&amp;quot;&amp;quot;&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;hr&gt;
&lt;h3 id="33-documents"&gt;3.3. Documents
&lt;/h3&gt;&lt;p&gt;LightRAG API Server æä¾›å…©é¡ä¸»è¦çš„ç«¯é»ï¼šä¸€é¡æ˜¯éµå¾ª OpenAI æ¨™æº–çš„æ ¸å¿ƒèŠå¤© APIï¼Œå¦ä¸€é¡æ˜¯ Web UI ç”¨æ–¼ç®¡ç†è³‡æ–™çš„ APIã€‚&lt;/p&gt;
&lt;h3 id="31-openai-æ¨™æº–-api"&gt;3.1. OpenAI æ¨™æº– API
&lt;/h3&gt;&lt;p&gt;é€™çµ„ API è®“ LightRAG å¯ä»¥è¼•æ˜“åœ°æ•´åˆé€²ç¾æœ‰çš„ OpenAI ç”Ÿæ…‹ç³»ã€‚&lt;/p&gt;
&lt;h4 id="311-get-apiv1models"&gt;3.1.1. &lt;code&gt;GET /api/v1/models&lt;/code&gt;
&lt;/h4&gt;&lt;p&gt;æ­¤ç«¯é»ç”¨æ–¼æŸ¥è©¢ç•¶å‰ä¼ºæœå™¨ä¸Šæ‰€æœ‰å¯ç”¨çš„æ¨¡å‹ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŠŸèƒ½&lt;/strong&gt;: åˆ—å‡ºåœ¨è¨­å®šæª”ä¸­å®šç¾©çš„æ‰€æœ‰æ¨¡å‹åç¨±ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¯„ä¾‹&lt;/strong&gt;:
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;curl -X GET http://localhost:8008/api/v1/models
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å›æ‡‰&lt;/strong&gt;:
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-json" data-lang="json"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;{
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;&amp;#34;object&amp;#34;&lt;/span&gt;: &lt;span style="color:#e6db74"&gt;&amp;#34;list&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;&amp;#34;data&amp;#34;&lt;/span&gt;: [
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;&amp;#34;id&amp;#34;&lt;/span&gt;: &lt;span style="color:#e6db74"&gt;&amp;#34;LightRAG&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;&amp;#34;object&amp;#34;&lt;/span&gt;: &lt;span style="color:#e6db74"&gt;&amp;#34;model&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;&amp;#34;created&amp;#34;&lt;/span&gt;: &lt;span style="color:#ae81ff"&gt;1721615822&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#f92672"&gt;&amp;#34;owned_by&amp;#34;&lt;/span&gt;: &lt;span style="color:#e6db74"&gt;&amp;#34;lightrag&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; ]
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="312-post-apiv1chatcompletions"&gt;3.1.2. &lt;code&gt;POST /api/v1/chat/completions&lt;/code&gt;
&lt;/h4&gt;&lt;p&gt;é€™æ˜¯æ ¸å¿ƒçš„èŠå¤©äº’å‹•ç«¯é»ï¼ŒåŠŸèƒ½èˆ‡ OpenAI çš„ Chat Completions API å®Œå…¨ç›¸å®¹ã€‚å®ƒæ¥æ”¶ä½¿ç”¨è€…è¼¸å…¥ï¼ŒåŸ·è¡Œ RAG æµç¨‹ï¼Œä¸¦å›å‚³ LLM ç”Ÿæˆçš„ç­”æ¡ˆã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åŠŸèƒ½&lt;/strong&gt;: åŸ·è¡Œä¸€å€‹å®Œæ•´çš„ RAG æŸ¥è©¢ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¯„ä¾‹&lt;/strong&gt;:
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;curl -X POST http://localhost:8008/api/v1/chat/completions &lt;span style="color:#ae81ff"&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ae81ff"&gt;&lt;/span&gt;-H &lt;span style="color:#e6db74"&gt;&amp;#34;Content-Type: application/json&amp;#34;&lt;/span&gt; &lt;span style="color:#ae81ff"&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ae81ff"&gt;&lt;/span&gt;-d &lt;span style="color:#e6db74"&gt;&amp;#39;{
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#e6db74"&gt; &amp;#34;model&amp;#34;: &amp;#34;LightRAG&amp;#34;,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#e6db74"&gt; &amp;#34;messages&amp;#34;: [
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#e6db74"&gt; {
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#e6db74"&gt; &amp;#34;role&amp;#34;: &amp;#34;user&amp;#34;,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#e6db74"&gt; &amp;#34;content&amp;#34;: &amp;#34;What is Retrieval-Augmented Generation?&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#e6db74"&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#e6db74"&gt; ]
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#e6db74"&gt;}&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="32-web-ui-api-ç¸½è¦½"&gt;3.2. Web UI API ç¸½è¦½
&lt;/h3&gt;&lt;p&gt;é€™çµ„ API ä¸»è¦ç”± LightRAG çš„ Web UI ä½¿ç”¨ï¼Œæä¾›æ–‡ä»¶è™•ç†ã€æŸ¥è©¢ã€çŸ¥è­˜åœ–è­œç®¡ç†ç­‰é€²éšåŠŸèƒ½ã€‚&lt;/p&gt;
&lt;h4 id="321-æ–‡ä»¶-documents-api"&gt;3.2.1. æ–‡ä»¶ (Documents) API
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style="text-align: left"&gt;æ–¹æ³•&lt;/th&gt;
&lt;th style="text-align: left"&gt;è·¯å¾‘&lt;/th&gt;
&lt;th style="text-align: left"&gt;èªªæ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;&lt;code&gt;POST&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;&lt;code&gt;/documents/scan&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;æƒæè¼¸å…¥è³‡æ–™å¤¾ä¸­çš„æ–°æ–‡ä»¶ä¸¦é€²è¡Œè™•ç†ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;&lt;code&gt;POST&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;&lt;code&gt;/documents/upload&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;ä¸Šå‚³æ–‡ä»¶è‡³è¼¸å…¥è³‡æ–™å¤¾ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;&lt;code&gt;POST&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;&lt;code&gt;/documents/text&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;æ’å…¥å–®ç­†æ–‡å­—è³‡æ–™ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;&lt;code&gt;POST&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;&lt;code&gt;/documents/texts&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;æ’å…¥å¤šç­†æ–‡å­—è³‡æ–™ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;&lt;code&gt;DELETE&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;&lt;code&gt;/documents&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;æ¸…é™¤æ‰€æœ‰å·²è™•ç†çš„æ–‡ä»¶è³‡æ–™ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;&lt;code&gt;GET&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;&lt;code&gt;/documents&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;ç²å–å·²è™•ç†çš„æ–‡ä»¶åˆ—è¡¨ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;&lt;code&gt;GET&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;&lt;code&gt;/documents/pipeline_status&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;ç²å–æ–‡ä»¶è™•ç†ç®¡é“çš„ç‹€æ…‹ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;&lt;code&gt;DELETE&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;&lt;code&gt;/documents/delete_document&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;æ ¹æ“šæ–‡ä»¶ ID åˆªé™¤æŒ‡å®šæ–‡ä»¶åŠå…¶ç›¸é—œè³‡æ–™ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;&lt;code&gt;POST&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;&lt;code&gt;/documents/clear_cache&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;æ¸…é™¤å¿«å–ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;&lt;code&gt;DELETE&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;&lt;code&gt;/documents/delete_entity&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;åˆªé™¤æŒ‡å®šçš„å¯¦é«”ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;&lt;code&gt;DELETE&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;&lt;code&gt;/documents/delete_relation&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;åˆªé™¤æŒ‡å®šçš„é—œä¿‚ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id="322-æŸ¥è©¢-query-api"&gt;3.2.2. æŸ¥è©¢ (Query) API
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style="text-align: left"&gt;æ–¹æ³•&lt;/th&gt;
&lt;th style="text-align: left"&gt;è·¯å¾‘&lt;/th&gt;
&lt;th style="text-align: left"&gt;èªªæ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;&lt;code&gt;POST&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;&lt;code&gt;/query&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;æäº¤ä¸€å€‹æŸ¥è©¢ä¸¦ç²å–ä¸€æ¬¡æ€§å›è¦†ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;&lt;code&gt;POST&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;&lt;code&gt;/query/stream&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;æäº¤ä¸€å€‹æŸ¥è©¢ä¸¦ä»¥ä¸²æµæ–¹å¼ç²å–å›è¦†ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id="323-çŸ¥è­˜åœ–è­œ-graph-api"&gt;3.2.3. çŸ¥è­˜åœ–è­œ (Graph) API
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style="text-align: left"&gt;æ–¹æ³•&lt;/th&gt;
&lt;th style="text-align: left"&gt;è·¯å¾‘&lt;/th&gt;
&lt;th style="text-align: left"&gt;èªªæ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;&lt;code&gt;GET&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;&lt;code&gt;/graph/label/list&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;ç²å–çŸ¥è­˜åœ–è­œä¸­æ‰€æœ‰çš„æ¨™ç±¤ (Labels)ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;&lt;code&gt;GET&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;&lt;code&gt;/graphs&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;ç²å–å®Œæ•´çš„çŸ¥è­˜åœ–è­œè³‡æ–™ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;&lt;code&gt;GET&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;&lt;code&gt;/graph/entity/exists&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;æª¢æŸ¥æŒ‡å®šçš„å¯¦é«”æ˜¯å¦å­˜åœ¨ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;&lt;code&gt;POST&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;&lt;code&gt;/graph/entity/edit&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;æ›´æ–°ä¸€å€‹å¯¦é«”çš„è³‡è¨Šã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;&lt;code&gt;POST&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;&lt;code&gt;/graph/relation/edit&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;æ›´æ–°ä¸€å€‹é—œä¿‚çš„è³‡è¨Šã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id="324-ollama-ç›¸å®¹-api"&gt;3.2.4. Ollama ç›¸å®¹ API
&lt;/h4&gt;&lt;p&gt;LightRAG ä¹Ÿæä¾›èˆ‡ Ollama ç›¸å®¹çš„ API ç«¯é»ï¼Œæ–¹ä¾¿èˆ‡ç›¸é—œå·¥å…·æ•´åˆã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style="text-align: left"&gt;æ–¹æ³•&lt;/th&gt;
&lt;th style="text-align: left"&gt;è·¯å¾‘&lt;/th&gt;
&lt;th style="text-align: left"&gt;èªªæ˜&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;&lt;code&gt;GET&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;&lt;code&gt;/api/version&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;ç²å– API ç‰ˆæœ¬ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;&lt;code&gt;GET&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;&lt;code&gt;/api/tags&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;ç²å–å¯ç”¨çš„æ¨¡å‹æ¨™ç±¤ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;&lt;code&gt;GET&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;&lt;code&gt;/api/ps&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;ç²å–æ­£åœ¨é‹è¡Œçš„æ¨¡å‹ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;&lt;code&gt;POST&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;&lt;code&gt;/api/generate&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;æ ¹æ“šæç¤ºç”Ÿæˆæ–‡å­—ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left"&gt;&lt;code&gt;POST&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;&lt;code&gt;/api/chat&lt;/code&gt;&lt;/td&gt;
&lt;td style="text-align: left"&gt;é€²è¡ŒèŠå¤©äº’å‹•ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;hr&gt;
&lt;h2 id="4-ç¸½çµ"&gt;4. ç¸½çµ
&lt;/h2&gt;&lt;p&gt;LightRAG çš„ API Server æä¾›äº†ä¸€å€‹æ¨™æº–åŒ–ä¸”åŠŸèƒ½è±å¯Œçš„ä»‹é¢ï¼Œè®“é–‹ç™¼è€…èƒ½å°‡è¤‡é›œçš„ RAG æµç¨‹éƒ¨ç½²ç‚ºä¸€å€‹ç¨ç«‹æœå‹™ã€‚é€ééµå¾ª OpenAI çš„ API æ ¼å¼ä¸¦æä¾›å®Œæ•´çš„æ–‡ä»¶ç®¡ç† APIï¼Œå®ƒæ¥µå¤§åœ°é™ä½äº†æ•´åˆé–€æª»ï¼Œç„¡è«–æ˜¯é€²è¡Œå¿«é€ŸåŸå‹è¨­è¨ˆï¼Œé‚„æ˜¯å°‡å…¶æ•´åˆåˆ°ç¾æœ‰çš„æ‡‰ç”¨ç¨‹å¼ä¸­ï¼Œéƒ½è®Šå¾—éå¸¸æ–¹ä¾¿ã€‚å¸Œæœ›æœ¬ç¯‡æ•™å­¸èƒ½å¹«åŠ©æ‚¨é †åˆ©è¸å‡ºä½¿ç”¨ LightRAG çš„ç¬¬ä¸€æ­¥ã€‚&lt;/p&gt;</description></item><item><title>GraphRAG vs LightRAG</title><link>https://Dandelionlibra.github.io/post/note/graphrag-lightrag-compare/</link><pubDate>Thu, 31 Jul 2025 03:24:00 +0800</pubDate><guid>https://Dandelionlibra.github.io/post/note/graphrag-lightrag-compare/</guid><description>&lt;h1 id="rag-ç¨®é¡"&gt;RAG ç¨®é¡
&lt;/h1&gt;&lt;h2 id="native-rag"&gt;Native RAG
&lt;/h2&gt;&lt;p&gt;å˜—è©¦è§£æ±ºå…§éƒ¨è³‡è¨Šç¼ºå¤±çš„å•é¡Œã€‚&lt;br&gt;
RAG åœ¨å›ç­”å‰æœƒå…ˆåŸºæ–¼æå•èˆ‡è³‡æ–™åº«ä¸­å…§å®¹çš„èªæ„ç›¸ä¼¼åº¦ç¯©é¸å‡ºæœ€å…·é—œé€£çš„æ®µè½ (chunk) å†å°‡é€™äº›è³‡è¨Šå‚³çµ¦ LLM é€²è¡Œå›ç­”ï¼Œä½†å—é™æ–¼æª¢ç´¢åˆ°çš„ chunk å…§å®¹ï¼Œå› æ­¤è‹¥æ˜¯è©¢å•çš„å•é¡Œæ¯”è¼ƒå…¨é¢ï¼Œä¾‹å¦‚ä¸»é¡Œå¤§ç¶±ç­‰ç­‰ï¼Œå› ç‚ºéœ€è¦å…¨é¢çš„è³‡æ–™å…§å®¹ï¼Œä½†æª¢ç´¢å¾Œå»ä½¿æœƒæä¾›çµ¦ LLM éƒ¨åˆ†å…§å®¹è€Œå·²ï¼Œå› æ­¤å¯é æ¸¬å›ç­”æº–ç¢ºç‡å¤§æ¦‚ä¸é«˜ï¼Œä½†æ˜¯è‹¥æ˜¯æ³•è¦ç­‰å•é¡Œå›ç­”çµæœæœƒæ›´ç²¾ç¢ºã€‚&lt;/p&gt;
&lt;h2 id="graph-rag"&gt;Graph RAG
&lt;/h2&gt;&lt;p&gt;å˜—è©¦è§£æ±º Native RAG å›ç­”ä¸ç²¾ç¢ºçš„å•é¡Œã€‚&lt;/p&gt;
&lt;h2 id="light-rag"&gt;Light RAG
&lt;/h2&gt;&lt;hr&gt;
&lt;h1 id="å¼•è¨€"&gt;å¼•è¨€
&lt;/h1&gt;&lt;h2 id="ç¾æœ‰-rag-ç³»çµ±çš„å±€é™æ€§"&gt;ç¾æœ‰ RAG ç³»çµ±çš„å±€é™æ€§
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ä¾è³´å¹³é¢è³‡æ–™è¡¨ç¤ºï¼š&lt;/strong&gt; è¨±å¤šæ–¹æ³•ä¾è³´æ–¼å¹³é¢è³‡æ–™è¡¨ç¤ºï¼ˆflat data representationsï¼‰ï¼Œé™åˆ¶äº†å®ƒå€‘æ ¹æ“šå¯¦é«”ä¹‹é–“è¤‡é›œé—œä¿‚ä¾†ç†è§£å’Œæª¢ç´¢è³‡è¨Šçš„èƒ½åŠ›ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç¼ºä¹ä¸Šä¸‹æ–‡æ„ŸçŸ¥ï¼š&lt;/strong&gt; é€™äº›ç³»çµ±é€šå¸¸ç¼ºä¹ç¶­æŒä¸åŒå¯¦é«”åŠå…¶ç›¸äº’é—œä¿‚ä¹‹é–“é€£è²«æ€§æ‰€éœ€çš„ä¸Šä¸‹æ–‡æ„ŸçŸ¥èƒ½åŠ›ï¼Œå°è‡´å›æ‡‰å¯èƒ½ç„¡æ³•å®Œå…¨è§£æ±ºç”¨æˆ¶æŸ¥è©¢ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¾‹ï¼šè€ƒæ…®ç”¨æˆ¶æå•ã€Œé›»å‹•è»Šçš„èˆˆèµ·å¦‚ä½•å½±éŸ¿åŸå¸‚ç©ºæ°£å“è³ªå’Œå¤§çœ¾é‹è¼¸åŸºç¤è¨­æ–½ï¼Ÿã€ç¾æœ‰ RAG æ–¹æ³•å¯èƒ½æª¢ç´¢åˆ°é—œæ–¼é›»å‹•è»Šã€ç©ºæ°£æ±¡æŸ“å’Œå…¬å…±äº¤é€šæŒ‘æˆ°çš„ç¨ç«‹æ–‡æª”ï¼Œä½†é›£ä»¥å°‡é€™äº›ä¿¡æ¯ç¶œåˆç‚ºä¸€å€‹é€£è²«çš„å›æ‡‰ã€‚å®ƒå€‘å¯èƒ½ç„¡æ³•è§£é‡‹é›»å‹•è»Šçš„æ™®åŠå¦‚ä½•æ”¹å–„ç©ºæ°£å“è³ªï¼Œé€²è€Œå¯èƒ½å½±éŸ¿å…¬å…±äº¤é€šè¦åŠƒï¼Œç”¨æˆ¶å¯èƒ½æ”¶åˆ°ä¸€å€‹ç¢ç‰‡åŒ–çš„ç­”æ¡ˆï¼Œæœªèƒ½å……åˆ†æ•æ‰é€™äº›ä¸»é¡Œä¹‹é–“è¤‡é›œçš„ç›¸äº’ä¾è³´é—œä¿‚ã€‚&lt;/p&gt;&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="lightrag-æ¨¡å‹æ¦‚è¿°"&gt;LightRAG æ¨¡å‹æ¦‚è¿°
&lt;/h2&gt;&lt;p&gt;å¢å¼·äº†ç³»çµ±æ•æ‰å¯¦é«”ä¹‹é–“è¤‡é›œç›¸äº’ä¾è³´é—œä¿‚çš„èƒ½åŠ›ï¼Œå¾è€Œç”¢ç”Ÿæ›´é€£è²«å’Œä¸Šä¸‹æ–‡æ›´è±å¯Œçš„å›æ‡‰ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id="å…§æ–‡"&gt;å…§æ–‡
&lt;/h1&gt;&lt;h2 id="lightrag-æ¡†æ¶çš„æ•´é«”æ¶æ§‹"&gt;LightRAG æ¡†æ¶çš„æ•´é«”æ¶æ§‹
&lt;/h2&gt;&lt;p&gt;&lt;img src="https://raw.githubusercontent.com/HKUDS/LightRAG/refs/heads/main/README.assets/b2aaf634151b4706892693ffb43d9093.png"
loading="lazy"
alt="LightRAG æ¡†æ¶ç¸½è¦½"
&gt;&lt;br&gt;
&lt;em&gt;åœ– 1. LightRAG æ¡†æ¶ç¸½è¦½ï¼ˆå–è‡ªåŸè«–æ–‡ï¼‰&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;æ¶æ§‹å¦‚åœ– 1 æ‰€ç¤ºã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id="å¯¦é©—"&gt;å¯¦é©—
&lt;/h1&gt;&lt;hr&gt;
&lt;hr&gt;
&lt;h1 id="reference"&gt;Reference
&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;&lt;a class="link" href="https://www.youtube.com/watch?v=-O5ATdQcefo" target="_blank" rel="noopener"
&gt;LightRAGä¸GraphRAGå¯¹æ¯”è¯„æµ‹ï¼Œä»ç´¢å¼•æ„å»ºã€æœ¬åœ°æ£€ç´¢ã€å…¨å±€æ£€ç´¢ã€æ··åˆæ£€ç´¢ç­‰ç»´åº¦å¯¹è¯·æ±‚å¤§æ¨¡å‹æ¬¡æ•°ã€Tokenæ¶ˆè€—ã€é‡‘é¢æ¶ˆè€—ã€æ£€ç´¢è´¨é‡ç­‰æ–¹é¢è¿›è¡Œå…¨é¢å¯¹æ¯”&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="link" href="https://github.com/NanGePlus/LightRAGTest" target="_blank" rel="noopener"
&gt;GitHub: [LightRAGTest]&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</description></item><item><title>GraphRAG æ¦‚è«–</title><link>https://Dandelionlibra.github.io/post/note/graphrag-overview/</link><pubDate>Thu, 31 Jul 2025 03:24:00 +0800</pubDate><guid>https://Dandelionlibra.github.io/post/note/graphrag-overview/</guid><description>&lt;h1 id="graph-rag-åŸºæœ¬ä»‹ç´¹"&gt;Graph RAG åŸºæœ¬ä»‹ç´¹
&lt;/h1&gt;&lt;h2 id="graph-rag"&gt;Graph RAG
&lt;/h2&gt;&lt;p&gt;Native RAG å˜—è©¦è§£æ±ºå…§éƒ¨è³‡è¨Šç¼ºå¤±çš„å•é¡Œï¼Œä½†å—é™æ–¼æª¢ç´¢åˆ°çš„ chunk å…§å®¹ï¼Œå› æ­¤è‹¥æ˜¯è©¢å•çš„å•é¡Œæ¯”è¼ƒå…¨é¢ï¼Œä¾‹å¦‚ä¸»é¡Œå¤§ç¶±ç­‰ç­‰ï¼Œå› ç‚ºéœ€è¦å…¨é¢çš„è³‡æ–™å…§å®¹ï¼Œä½†æª¢ç´¢å¾Œå»åªæœƒæä¾›çµ¦ LLM éƒ¨åˆ†å…§å®¹è€Œå·²ã€‚è€Œç‚ºäº†è§£æ±ºå…¨åŸŸè³‡è¨Šç¼ºå¤±çš„å•é¡Œå› è€Œèª•ç”Ÿäº† Graph RAGã€‚&lt;/p&gt;
&lt;p&gt;Graph RAG é€éå°‡éçµæ§‹åŒ–æ–‡æœ¬è½‰æ›ç‚ºçŸ¥è­˜åœ–è­œä¾†è§£æ±º Native RAG çš„å•é¡Œã€‚å®ƒä¸åƒ…åƒ…æ˜¯æª¢ç´¢æ–‡æœ¬ç‰‡æ®µï¼Œè€Œæ˜¯ç†è§£å¯¦é«”ä¹‹é–“çš„é—œä¿‚ï¼Œå¾è€Œèƒ½å¤ å›ç­”æ›´è¤‡é›œã€éœ€è¦ç¶œåˆå¤šæ–¹é¢è³‡è¨Šçš„å•é¡Œã€‚&lt;/p&gt;
&lt;p&gt;node è¡¨ç¤ºæ¯å€‹ä¸»é«”ï¼Œè€Œ edge å‰‡æ˜¯è¡¨ç¤ºäº†æ¯å€‹ entity é–“çš„é—œä¿‚ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://raw.githubusercontent.com/Dandelionlibra/Dandelionlibra.github.io/refs/heads/main/content/post/note/assert/GraphRag%20relation%20graph.png"
loading="lazy"
alt="Graph RAG é—œä¿‚åœ–"
&gt;
&lt;em&gt;åœ–ï¼šGraph RAG å°‡æ–‡æœ¬ä¸­çš„å¯¦é«”å’Œé—œä¿‚æŠ½å–å‡ºä¾†ï¼Œæ§‹å»ºæˆçŸ¥è­˜åœ–è­œã€‚ï¼ˆåœ–ç‰‡ä¾†æºï¼š&lt;a class="link" href="https://www.youtube.com/watch?v=A1XSpKC2GHc&amp;amp;t=360s" target="_blank" rel="noopener"
&gt;Microsoft Graph RAG ä»‹ç´¹&lt;/a&gt;ï¼‰&lt;/em&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id="graph-rag-pipeline"&gt;Graph RAG Pipeline
&lt;/h1&gt;&lt;p&gt;&lt;img src="https://raw.githubusercontent.com/Dandelionlibra/Dandelionlibra.github.io/refs/heads/main/content/post/note/assert/GraphRag%20pipline.png"
loading="lazy"
alt="Graph RAG pipline"
&gt;
&lt;em&gt;åœ–ï¼šGraph RAG å°‡æ–‡æœ¬ä¸­çš„å¯¦é«”å’Œé—œä¿‚æŠ½å–å‡ºä¾†ï¼Œæ§‹å»ºæˆçŸ¥è­˜åœ–è­œã€‚ï¼ˆåœ–ç‰‡ä¾†æºï¼š&lt;a class="link" href="https://arxiv.org/abs/2404.16130" target="_blank" rel="noopener"
&gt;Microsoft Graph RAG ä»‹ç´¹&lt;/a&gt;ï¼‰&lt;/em&gt;&lt;/p&gt;
&lt;h2 id="1-source-documents--text-chunks"&gt;1. Source Documents â†’ Text Chunks
&lt;/h2&gt;&lt;p&gt;å°‡é•·æ–‡ä»¶è½‰æ›æˆå° chunksï¼Œæ¯å€‹ chunks size è¶Šå¤§å‰‡ç”¢ç”Ÿçš„ chunk è¶Šå°‘ã€‚&lt;/p&gt;
&lt;h2 id="2-text-chunks--element-instances"&gt;2. Text Chunks â†’ Element Instances
&lt;/h2&gt;&lt;p&gt;ä½¿ç”¨å¤šè¼ªå° LLM çš„å•ç­”ä»¥å®Œå–„æ‰€æœ‰ä¸»é«”èˆ‡å½¼æ­¤ä¹‹é–“çš„é—œè¯ã€‚&lt;br&gt;
ä¾‹ï¼Œè®“ LLM ç”Ÿæˆè³‡æ–™åº«ä¸­è³‡è¨Šçš„é—œä¿‚ï¼Œæ¥è‘—æ‹¿ç”Ÿæˆçš„æ±è¥¿å»è©¢å• LLM ç”Ÿæˆçš„çµæœæ˜¯å¦é‚„æœ‰ç¼ºå¤±?&lt;br&gt;
è‹¥æœ‰ï¼Œå‰‡å†æ¬¡è®“ LLM è£œå…¨ï¼Œä¸€ç›´é‡è¤‡åˆ° LLM å›ç­”å¯ä»¥ç‚ºæ­¢ã€‚&lt;/p&gt;
&lt;h2 id="3-element-instances--element-summaries"&gt;3. Element Instances â†’ Element Summaries
&lt;/h2&gt;&lt;p&gt;ä½¿ç”¨ä¸€å€‹é¡å¤–çš„ LLM è¼¸å…¥ Entity èˆ‡ä»–çš„ Relationshipï¼Œè¼¸å‡ºé‡å°æ­¤ Entity Summary çš„æè¿°ã€‚&lt;/p&gt;
&lt;h2 id="4-element-summaries--graph-communities"&gt;4. Element Summaries â†’ Graph Communities
&lt;/h2&gt;&lt;p&gt;å°‡ç›¸åŒä¸»é¡Œçš„å…§å®¹æ¡†æˆåŒæ¨£çš„ Communityã€‚&lt;br&gt;
ä½¿ç”¨çš„æ¼”ç®—æ³•æ˜¯ Leiden community detection algorithmï¼ŒåŸå‰‡ä¸Šæ˜¯ç›¸åŒ Community ä¸­çš„ entity é–“çš„é—œä¿‚è¶Šè¤‡é›œè¶Šå¥½ï¼Œè€Œä¸åŒ Community ä¸­çš„ entity é–“é—œä¿‚è¶Šç°¡å–®è¶Šå¥½ã€‚&lt;br&gt;
&lt;img src="https://raw.githubusercontent.com/Dandelionlibra/Dandelionlibra.github.io/refs/heads/main/content/post/note/assert/GraphRag%20relation%20graph-2.png"
loading="lazy"
alt="Graph RAG é—œä¿‚åœ–"
&gt;
&lt;em&gt;åœ–ï¼šGraph RAG community detectionã€‚ï¼ˆåœ–ç‰‡ä¾†æºï¼š&lt;a class="link" href="https://www.youtube.com/watch?v=A1XSpKC2GHc&amp;amp;t=780s" target="_blank" rel="noopener"
&gt;Microsoft Graph RAG ä»‹ç´¹&lt;/a&gt;ï¼‰&lt;/em&gt;&lt;/p&gt;
&lt;h2 id="5-graph-communities--community-summaries"&gt;5. Graph Communities â†’ Community Summaries
&lt;/h2&gt;&lt;p&gt;å°‡åŒä¸€å€‹ community ä¸­çš„ entity éƒ½çµ„åˆèµ·ä¾†ï¼Œè©¢å• LLM æ•´å€‹æ­¤é¡åˆ¥ community çš„æ‘˜è¦ï¼Œä»¥ç¬¬å››é»çš„åœ–ç‚ºä¾‹ï¼Œå°±æœƒç”¢ç”Ÿä¸‰å€‹ Community Summariesã€‚&lt;br&gt;
è‹¥çŸ¥è­˜åœ–è­œéå¸¸å¤§ï¼Œå‰‡å¯èƒ½ç„¡æ³•å°‡æ‰€æœ‰ entity éƒ½å‚³çµ¦ LLM å‰‡å¯ä»¥ä¾ç…§ community ä¸­ entity çš„é‡è¦æ€§æ±ºå®šæ˜¯å¦è¦å…ˆæ”¾å…¥(é‡è¦æ€§ä¾ç…§å–®ä¸€ node çš„ relation æ•¸é‡æ±ºå®š)ã€‚&lt;/p&gt;
&lt;h2 id="6-community-summaries--community-answers--global-answer"&gt;6. Community Summaries â†’ Community Answers â†’ Global Answer
&lt;/h2&gt;&lt;p&gt;ä¾æ“š Community Summaries å›ç­”å•é¡Œã€‚&lt;br&gt;
å°‡å•é¡Œæ‹¿å»ä¸€ä¸€å•æ¯å€‹ Community Summariesï¼Œå¾—åˆ°å„è‡ªçš„ Community å›ç­”å¾Œï¼Œå†å°‡é€™äº›æ¯”è¼ƒç‰‡é¢çš„å›ç­”æ•´åˆæˆ global answerã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://raw.githubusercontent.com/Dandelionlibra/Dandelionlibra.github.io/refs/heads/main/content/post/note/assert/step6%20GraphRag%20pipline.png"
loading="lazy"
alt="Graph RAG é—œä¿‚åœ–"
&gt;
&lt;em&gt;åœ–ï¼šCommunity Summaries â†’ Community Answers â†’ Global Answerã€‚ï¼ˆåœ–ç‰‡ä¾†æºï¼š&lt;a class="link" href="https://www.youtube.com/watch?v=A1XSpKC2GHc&amp;amp;t=1040s" target="_blank" rel="noopener"
&gt;Microsoft Graph RAG ä»‹ç´¹&lt;/a&gt;ï¼‰&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æ­¤å°±å¯ä»¥è§£æ±º Native RAG åªçœ‹éƒ¨åˆ†è³‡è¨Šï¼Œè€Œä½¿çš„å›ç­”ç¼ºå°‘å…¶é¤˜è³‡è¨Šçš„å¯èƒ½ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h1 id="çµè«–"&gt;çµè«–
&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;GraphRAG å±•ç¾äº†æ›´å¥½çš„å…¨åŸŸæª¢ç´¢èƒ½åŠ›ã€‚&lt;/li&gt;
&lt;li&gt;å»ºé€ çŸ¥è­˜åœ–è­œèŠ±è²»çš„æˆæœ¬é é«˜æ–¼ Native RAGã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h1 id="reference"&gt;Reference
&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;&lt;a class="link" href="https://www.youtube.com/watch?v=A1XSpKC2GHc&amp;amp;t=240s" target="_blank" rel="noopener"
&gt;Microsoft Graph RAG ä»‹ç´¹ï¼šç”¨ Knowledge Graph ä¾†åš RAGï¼‹Colab å¯¦ä½œ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="link" href="https://www.youtube.com/watch?v=7WFMd8U8C7E" target="_blank" rel="noopener"
&gt;GraphRAGå‘å¸ƒé‡å¤§æ›´æ–°ï¼å¢é‡æ›´æ–°ç´¢å¼•ç»ˆäºæ¥å¹¶æ–°å¢DRIFTå›¾æ¨ç†æœç´¢æŸ¥è¯¢ï¼Œå¸¦ä½ æ‰‹æŠŠæ‰‹å…¨æµç¨‹å®æ“æ–°åŠŸèƒ½ï¼Œæºç åˆ†æï¼ŒåŒæ—¶æ”¯æŒGPTã€å›½äº§å¤§æ¨¡å‹ã€æœ¬åœ°å¤§æ¨¡å‹ç­‰&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="link" href="https://github.com/NanGePlus/GraphRAGTestV040" target="_blank" rel="noopener"
&gt;GitHub: [GraphRAGTestV040]&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</description></item><item><title>BAAI/bge-reranker-v2-m3 â€” Hugging Face å®˜æ–¹æ•´ç†</title><link>https://Dandelionlibra.github.io/post/note/bge-reranker-hf-flagembedding-note/</link><pubDate>Wed, 23 Jul 2025 03:51:00 +0800</pubDate><guid>https://Dandelionlibra.github.io/post/note/bge-reranker-hf-flagembedding-note/</guid><description>&lt;h2 id="reranker-æ¨¡å‹èˆ‡å‡½å¼åº«ä½¿ç”¨å·®ç•°ç­†è¨˜"&gt;Reranker æ¨¡å‹èˆ‡å‡½å¼åº«ä½¿ç”¨å·®ç•°ç­†è¨˜
&lt;/h2&gt;&lt;p&gt;é€™ä»½ç­†è¨˜æ•´ç†äº† FlagEmbedding å’Œ Hugging Face Transformers åœ¨å¯¦ä½œä¸åŒ Reranker æ¨¡å‹ï¼ˆæ¨™æº–å‹ã€LLM å‹ã€åˆ†å±¤å¼ LLM å‹ï¼‰æ™‚çš„é—œéµå·®ç•°ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id="æ ¸å¿ƒå¯¦ä½œæ¯”è¼ƒ"&gt;æ ¸å¿ƒå¯¦ä½œæ¯”è¼ƒ
&lt;/h3&gt;&lt;h4 id="flagembedding"&gt;FlagEmbedding
&lt;/h4&gt;&lt;p&gt;&lt;code&gt;FlagEmbedding&lt;/code&gt; å‡½å¼åº«æä¾›äº†æ›´ç°¡æ½”ã€é«˜åº¦å°è£çš„ APIï¼Œé©åˆå¿«é€Ÿæ•´åˆå’Œé«˜æ•ˆèƒ½æ‡‰ç”¨ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ¨™æº– Reranker (bge-reranker-base / large / v2-m3)&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;æ–¹æ³•: ä½¿ç”¨ &lt;code&gt;FlagReranker&lt;/code&gt; é¡åˆ¥ã€‚&lt;/li&gt;
&lt;li&gt;ç‰¹é»: æœ€ç›´æ¥ã€å„ªåŒ–çš„æ–¹æ³•ï¼Œç°¡åŒ–æ¨¡å‹è¼‰å…¥å’Œè¨ˆç®—ã€‚&lt;/li&gt;
&lt;li&gt;ç¨‹å¼ç¢¼ç¯„ä¾‹:
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;from&lt;/span&gt; FlagEmbedding &lt;span style="color:#f92672"&gt;import&lt;/span&gt; FlagReranker
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;# Setting use_fp16 to True speeds up computation with a slight performance degradation&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;reranker &lt;span style="color:#f92672"&gt;=&lt;/span&gt; FlagReranker(&lt;span style="color:#e6db74"&gt;&amp;#39;BAAI/bge-reranker-v2-m3&amp;#39;&lt;/span&gt;, use_fp16&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#66d9ef"&gt;True&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;score &lt;span style="color:#f92672"&gt;=&lt;/span&gt; reranker&lt;span style="color:#f92672"&gt;.&lt;/span&gt;compute_score([&lt;span style="color:#e6db74"&gt;&amp;#39;query&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;passage&amp;#39;&lt;/span&gt;])
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;print(score) &lt;span style="color:#75715e"&gt;# -5.65234375&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;# Map the scores into 0-1 by set &amp;#34;normalize=True&amp;#34;, which will apply sigmoid function to the score&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;score &lt;span style="color:#f92672"&gt;=&lt;/span&gt; reranker&lt;span style="color:#f92672"&gt;.&lt;/span&gt;compute_score([&lt;span style="color:#e6db74"&gt;&amp;#39;query&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;passage&amp;#39;&lt;/span&gt;], normalize&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#66d9ef"&gt;True&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;print(score) &lt;span style="color:#75715e"&gt;# 0.003497010252573502&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;scores &lt;span style="color:#f92672"&gt;=&lt;/span&gt; reranker&lt;span style="color:#f92672"&gt;.&lt;/span&gt;compute_score([[&lt;span style="color:#e6db74"&gt;&amp;#39;what is panda?&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;hi&amp;#39;&lt;/span&gt;], [&lt;span style="color:#e6db74"&gt;&amp;#39;what is panda?&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;The giant panda (Ailuropoda melanoleuca), sometimes called a panda bear or simply panda, is a bear species endemic to China.&amp;#39;&lt;/span&gt;]])
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;print(scores) &lt;span style="color:#75715e"&gt;# [-8.1875, 5.26171875]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;# set &amp;#34;normalize=True&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;scores &lt;span style="color:#f92672"&gt;=&lt;/span&gt; reranker&lt;span style="color:#f92672"&gt;.&lt;/span&gt;compute_score([[&lt;span style="color:#e6db74"&gt;&amp;#39;what is panda?&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;hi&amp;#39;&lt;/span&gt;], [&lt;span style="color:#e6db74"&gt;&amp;#39;what is panda?&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;The giant panda (Ailuropoda melanoleuca), sometimes called a panda bear or simply panda, is a bear species endemic to China.&amp;#39;&lt;/span&gt;]], normalize&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#66d9ef"&gt;True&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;print(scores) &lt;span style="color:#75715e"&gt;# [0.00027803096387751553, 0.9948403768236574]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="2"&gt;
&lt;li&gt;LLM-based Reranker&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;æ–¹æ³•: åˆ©ç”¨ &lt;code&gt;FlagLLMReranker&lt;/code&gt; é¡åˆ¥ã€‚&lt;/li&gt;
&lt;li&gt;ç‰¹é»: å°‡å¤§å‹èªè¨€æ¨¡å‹ï¼ˆå¦‚ Llamaï¼‰ä½œç‚º Rerankerï¼Œåˆ©ç”¨å…¶èªè¨€ç†è§£èƒ½åŠ›é€²è¡Œç´°ç·»æ’åºã€‚éœ€è¦å¤§é‡ VRAM (&amp;gt;40G)ã€‚&lt;/li&gt;
&lt;li&gt;ç¨‹å¼ç¢¼ç¯„ä¾‹:
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;from&lt;/span&gt; FlagEmbedding &lt;span style="color:#f92672"&gt;import&lt;/span&gt; FlagLLMReranker
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;# Setting use_fp16 to True speeds up computation with a slight performance degradation&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;reranker &lt;span style="color:#f92672"&gt;=&lt;/span&gt; FlagLLMReranker(&lt;span style="color:#e6db74"&gt;&amp;#39;BAAI/bge-reranker-v2-gemma&amp;#39;&lt;/span&gt;, use_fp16&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#66d9ef"&gt;True&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;score &lt;span style="color:#f92672"&gt;=&lt;/span&gt; reranker&lt;span style="color:#f92672"&gt;.&lt;/span&gt;compute_score([&lt;span style="color:#e6db74"&gt;&amp;#39;query&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;passage&amp;#39;&lt;/span&gt;])
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;print(score)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;scores &lt;span style="color:#f92672"&gt;=&lt;/span&gt; reranker&lt;span style="color:#f92672"&gt;.&lt;/span&gt;compute_score([[&lt;span style="color:#e6db74"&gt;&amp;#39;what is panda?&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;hi&amp;#39;&lt;/span&gt;], [&lt;span style="color:#e6db74"&gt;&amp;#39;what is panda?&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;The giant panda (Ailuropoda melanoleuca), sometimes called a panda bear or simply panda, is a bear species endemic to China.&amp;#39;&lt;/span&gt;]])
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;print(scores)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="3"&gt;
&lt;li&gt;LLM-based Layerwise Reranker&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;æ–¹æ³•: é€é FlagLLMReranker çš„ compute_score_layerwise æ–¹æ³•ã€‚&lt;/li&gt;
&lt;li&gt;ç‰¹é»: å¯å¾ LLM çš„ä¸åŒå±¤ç²å–åˆ†æ•¸ï¼Œæä¾›å°æ¨¡å‹æ±ºç­–éç¨‹çš„æ·±å…¥æ´å¯Ÿã€‚&lt;/li&gt;
&lt;li&gt;ç¨‹å¼ç¢¼ç¯„ä¾‹:
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;from&lt;/span&gt; FlagEmbedding &lt;span style="color:#f92672"&gt;import&lt;/span&gt; LayerWiseFlagLLMReranker
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;# Setting use_fp16 to True speeds up computation with a slight performance degradation&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;reranker &lt;span style="color:#f92672"&gt;=&lt;/span&gt; LayerWiseFlagLLMReranker(&lt;span style="color:#e6db74"&gt;&amp;#39;BAAI/bge-reranker-v2-minicpm-layerwise&amp;#39;&lt;/span&gt;, use_fp16&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#66d9ef"&gt;True&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;# Adjusting &amp;#39;cutoff_layers&amp;#39; to pick which layers are used for computing the score.&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;score &lt;span style="color:#f92672"&gt;=&lt;/span&gt; reranker&lt;span style="color:#f92672"&gt;.&lt;/span&gt;compute_score([&lt;span style="color:#e6db74"&gt;&amp;#39;query&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;passage&amp;#39;&lt;/span&gt;], cutoff_layers&lt;span style="color:#f92672"&gt;=&lt;/span&gt;[&lt;span style="color:#ae81ff"&gt;28&lt;/span&gt;])
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;print(score)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;scores &lt;span style="color:#f92672"&gt;=&lt;/span&gt; reranker&lt;span style="color:#f92672"&gt;.&lt;/span&gt;compute_score([[&lt;span style="color:#e6db74"&gt;&amp;#39;what is panda?&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;hi&amp;#39;&lt;/span&gt;], [&lt;span style="color:#e6db74"&gt;&amp;#39;what is panda?&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;The giant panda (Ailuropoda melanoleuca), sometimes called a panda bear or simply panda, is a bear species endemic to China.&amp;#39;&lt;/span&gt;]], cutoff_layers&lt;span style="color:#f92672"&gt;=&lt;/span&gt;[&lt;span style="color:#ae81ff"&gt;28&lt;/span&gt;])
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;print(scores)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h4 id="hugging-face-transformers"&gt;Hugging Face Transformers
&lt;/h4&gt;&lt;p&gt;Hugging Face Transformers å‡½å¼åº«æä¾›äº†æ›´é€šç”¨å’Œéˆæ´»çš„æ–¹æ³•ï¼Œé©åˆéœ€è¦æ·±åº¦è‡ªè¨‚å’Œå­¸è¡“ç ”ç©¶çš„å ´æ™¯ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ¨™æº– Reranker (bge-reranker-base / large / v2-m3)&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;æ–¹æ³•: è¼‰å…¥ AutoTokenizer å’Œ AutoModelForSequenceClassificationã€‚&lt;/li&gt;
&lt;li&gt;ç‰¹é»: æ¨™æº–æµç¨‹ï¼Œæä¾›æ›´å¤šè‡ªè¨‚ç©ºé–“ã€‚&lt;/li&gt;
&lt;li&gt;ç¨‹å¼ç¢¼ç¯„ä¾‹:
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;import&lt;/span&gt; torch
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;from&lt;/span&gt; transformers &lt;span style="color:#f92672"&gt;import&lt;/span&gt; AutoModelForSequenceClassification, AutoTokenizer
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;tokenizer &lt;span style="color:#f92672"&gt;=&lt;/span&gt; AutoTokenizer&lt;span style="color:#f92672"&gt;.&lt;/span&gt;from_pretrained(&lt;span style="color:#e6db74"&gt;&amp;#39;BAAI/bge-reranker-v2-m3&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;model &lt;span style="color:#f92672"&gt;=&lt;/span&gt; AutoModelForSequenceClassification&lt;span style="color:#f92672"&gt;.&lt;/span&gt;from_pretrained(&lt;span style="color:#e6db74"&gt;&amp;#39;BAAI/bge-reranker-v2-m3&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;model&lt;span style="color:#f92672"&gt;.&lt;/span&gt;eval()
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;pairs &lt;span style="color:#f92672"&gt;=&lt;/span&gt; [[&lt;span style="color:#e6db74"&gt;&amp;#39;what is panda?&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;hi&amp;#39;&lt;/span&gt;], [&lt;span style="color:#e6db74"&gt;&amp;#39;what is panda?&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;The giant panda (Ailuropoda melanoleuca), sometimes called a panda bear or simply panda, is a bear species endemic to China.&amp;#39;&lt;/span&gt;]]
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;with&lt;/span&gt; torch&lt;span style="color:#f92672"&gt;.&lt;/span&gt;no_grad(): &lt;span style="color:#75715e"&gt;# ç„¡æ¢¯åº¦ä¸‹é™&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; inputs &lt;span style="color:#f92672"&gt;=&lt;/span&gt; tokenizer(pairs, padding&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#66d9ef"&gt;True&lt;/span&gt;, truncation&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#66d9ef"&gt;True&lt;/span&gt;, return_tensors&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#39;pt&amp;#39;&lt;/span&gt;, max_length&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;512&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; scores &lt;span style="color:#f92672"&gt;=&lt;/span&gt; model(&lt;span style="color:#f92672"&gt;**&lt;/span&gt;inputs, return_dict&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#66d9ef"&gt;True&lt;/span&gt;)&lt;span style="color:#f92672"&gt;.&lt;/span&gt;logits&lt;span style="color:#f92672"&gt;.&lt;/span&gt;view(&lt;span style="color:#f92672"&gt;-&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;1&lt;/span&gt;, )&lt;span style="color:#f92672"&gt;.&lt;/span&gt;float()
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; print(scores)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="2"&gt;
&lt;li&gt;LLM-based Reranker&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;æ–¹æ³•: è¼‰å…¥ AutoTokenizer å’Œ AutoModelForCausalLMã€‚&lt;/li&gt;
&lt;li&gt;ç‰¹é»: éœ€è¦æ‰‹å‹•è™•ç†æ¨¡å‹è¼¸å‡ºä»¥ç²å¾—åˆ†æ•¸ï¼Œæä¾›æœ€å¤§çš„éˆæ´»æ€§å’Œæ§åˆ¶åŠ›ã€‚&lt;/li&gt;
&lt;li&gt;ç¨‹å¼ç¢¼ç¯„ä¾‹:
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;import&lt;/span&gt; torch
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;from&lt;/span&gt; transformers &lt;span style="color:#f92672"&gt;import&lt;/span&gt; AutoModelForCausalLM, AutoTokenizer
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;def&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;get_inputs&lt;/span&gt;(pairs, tokenizer, prompt&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#66d9ef"&gt;None&lt;/span&gt;, max_length&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;1024&lt;/span&gt;):
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;if&lt;/span&gt; prompt &lt;span style="color:#f92672"&gt;is&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;None&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; prompt &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;Given a query A and a passage B, determine whether the passage contains an answer to the query by providing a prediction of either &amp;#39;Yes&amp;#39; or &amp;#39;No&amp;#39;.&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; sep &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;\n&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; prompt_inputs &lt;span style="color:#f92672"&gt;=&lt;/span&gt; tokenizer(prompt,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; return_tensors&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#66d9ef"&gt;None&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; add_special_tokens&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#66d9ef"&gt;False&lt;/span&gt;)[&lt;span style="color:#e6db74"&gt;&amp;#39;input_ids&amp;#39;&lt;/span&gt;]
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; sep_inputs &lt;span style="color:#f92672"&gt;=&lt;/span&gt; tokenizer(sep,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; return_tensors&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#66d9ef"&gt;None&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; add_special_tokens&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#66d9ef"&gt;False&lt;/span&gt;)[&lt;span style="color:#e6db74"&gt;&amp;#39;input_ids&amp;#39;&lt;/span&gt;]
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; inputs &lt;span style="color:#f92672"&gt;=&lt;/span&gt; []
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;for&lt;/span&gt; query, passage &lt;span style="color:#f92672"&gt;in&lt;/span&gt; pairs:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; query_inputs &lt;span style="color:#f92672"&gt;=&lt;/span&gt; tokenizer(&lt;span style="color:#e6db74"&gt;f&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#39;A: &lt;/span&gt;&lt;span style="color:#e6db74"&gt;{&lt;/span&gt;query&lt;span style="color:#e6db74"&gt;}&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; return_tensors&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#66d9ef"&gt;None&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; add_special_tokens&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#66d9ef"&gt;False&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; max_length&lt;span style="color:#f92672"&gt;=&lt;/span&gt;max_length &lt;span style="color:#f92672"&gt;*&lt;/span&gt; &lt;span style="color:#ae81ff"&gt;3&lt;/span&gt; &lt;span style="color:#f92672"&gt;//&lt;/span&gt; &lt;span style="color:#ae81ff"&gt;4&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; truncation&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#66d9ef"&gt;True&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; passage_inputs &lt;span style="color:#f92672"&gt;=&lt;/span&gt; tokenizer(&lt;span style="color:#e6db74"&gt;f&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#39;B: &lt;/span&gt;&lt;span style="color:#e6db74"&gt;{&lt;/span&gt;passage&lt;span style="color:#e6db74"&gt;}&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; return_tensors&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#66d9ef"&gt;None&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; add_special_tokens&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#66d9ef"&gt;False&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; max_length&lt;span style="color:#f92672"&gt;=&lt;/span&gt;max_length,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; truncation&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#66d9ef"&gt;True&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; item &lt;span style="color:#f92672"&gt;=&lt;/span&gt; tokenizer&lt;span style="color:#f92672"&gt;.&lt;/span&gt;prepare_for_model(
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; [tokenizer&lt;span style="color:#f92672"&gt;.&lt;/span&gt;bos_token_id] &lt;span style="color:#f92672"&gt;+&lt;/span&gt; query_inputs[&lt;span style="color:#e6db74"&gt;&amp;#39;input_ids&amp;#39;&lt;/span&gt;],
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; sep_inputs &lt;span style="color:#f92672"&gt;+&lt;/span&gt; passage_inputs[&lt;span style="color:#e6db74"&gt;&amp;#39;input_ids&amp;#39;&lt;/span&gt;],
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; truncation&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#39;only_second&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; max_length&lt;span style="color:#f92672"&gt;=&lt;/span&gt;max_length,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; padding&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#66d9ef"&gt;False&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; return_attention_mask&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#66d9ef"&gt;False&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; return_token_type_ids&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#66d9ef"&gt;False&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; add_special_tokens&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#66d9ef"&gt;False&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; )
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; item[&lt;span style="color:#e6db74"&gt;&amp;#39;input_ids&amp;#39;&lt;/span&gt;] &lt;span style="color:#f92672"&gt;=&lt;/span&gt; item[&lt;span style="color:#e6db74"&gt;&amp;#39;input_ids&amp;#39;&lt;/span&gt;] &lt;span style="color:#f92672"&gt;+&lt;/span&gt; sep_inputs &lt;span style="color:#f92672"&gt;+&lt;/span&gt; prompt_inputs
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; item[&lt;span style="color:#e6db74"&gt;&amp;#39;attention_mask&amp;#39;&lt;/span&gt;] &lt;span style="color:#f92672"&gt;=&lt;/span&gt; [&lt;span style="color:#ae81ff"&gt;1&lt;/span&gt;] &lt;span style="color:#f92672"&gt;*&lt;/span&gt; len(item[&lt;span style="color:#e6db74"&gt;&amp;#39;input_ids&amp;#39;&lt;/span&gt;])
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; inputs&lt;span style="color:#f92672"&gt;.&lt;/span&gt;append(item)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;return&lt;/span&gt; tokenizer&lt;span style="color:#f92672"&gt;.&lt;/span&gt;pad(
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; inputs,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; padding&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#66d9ef"&gt;True&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; max_length&lt;span style="color:#f92672"&gt;=&lt;/span&gt;max_length &lt;span style="color:#f92672"&gt;+&lt;/span&gt; len(sep_inputs) &lt;span style="color:#f92672"&gt;+&lt;/span&gt; len(prompt_inputs),
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; pad_to_multiple_of&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;8&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; return_tensors&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#39;pt&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; )
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;tokenizer &lt;span style="color:#f92672"&gt;=&lt;/span&gt; AutoTokenizer&lt;span style="color:#f92672"&gt;.&lt;/span&gt;from_pretrained(&lt;span style="color:#e6db74"&gt;&amp;#39;BAAI/bge-reranker-v2-gemma&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;model &lt;span style="color:#f92672"&gt;=&lt;/span&gt; AutoModelForCausalLM&lt;span style="color:#f92672"&gt;.&lt;/span&gt;from_pretrained(&lt;span style="color:#e6db74"&gt;&amp;#39;BAAI/bge-reranker-v2-gemma&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;yes_loc &lt;span style="color:#f92672"&gt;=&lt;/span&gt; tokenizer(&lt;span style="color:#e6db74"&gt;&amp;#39;Yes&amp;#39;&lt;/span&gt;, add_special_tokens&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#66d9ef"&gt;False&lt;/span&gt;)[&lt;span style="color:#e6db74"&gt;&amp;#39;input_ids&amp;#39;&lt;/span&gt;][&lt;span style="color:#ae81ff"&gt;0&lt;/span&gt;]
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;model&lt;span style="color:#f92672"&gt;.&lt;/span&gt;eval()
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;pairs &lt;span style="color:#f92672"&gt;=&lt;/span&gt; [[&lt;span style="color:#e6db74"&gt;&amp;#39;what is panda?&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;hi&amp;#39;&lt;/span&gt;], [&lt;span style="color:#e6db74"&gt;&amp;#39;what is panda?&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;The giant panda (Ailuropoda melanoleuca), sometimes called a panda bear or simply panda, is a bear species endemic to China.&amp;#39;&lt;/span&gt;]]
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;with&lt;/span&gt; torch&lt;span style="color:#f92672"&gt;.&lt;/span&gt;no_grad():
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; inputs &lt;span style="color:#f92672"&gt;=&lt;/span&gt; get_inputs(pairs, tokenizer)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; scores &lt;span style="color:#f92672"&gt;=&lt;/span&gt; model(&lt;span style="color:#f92672"&gt;**&lt;/span&gt;inputs, return_dict&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#66d9ef"&gt;True&lt;/span&gt;)&lt;span style="color:#f92672"&gt;.&lt;/span&gt;logits[:, &lt;span style="color:#f92672"&gt;-&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;1&lt;/span&gt;, yes_loc]&lt;span style="color:#f92672"&gt;.&lt;/span&gt;view(&lt;span style="color:#f92672"&gt;-&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;1&lt;/span&gt;, )&lt;span style="color:#f92672"&gt;.&lt;/span&gt;float()
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; print(scores)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start="3"&gt;
&lt;li&gt;LLM-based Layerwise Reranker&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;æ–¹æ³•: é€éæ‰‹å‹•å­˜å– AutoModelForCausalLM çš„éš±è—å±¤è¼¸å‡ºæˆ–æ³¨æ„åŠ›æ¬Šé‡ï¼Œä¸¦è‡ªè¡Œè¨ˆç®—åˆ†æ•¸ã€‚&lt;/li&gt;
&lt;li&gt;ç‰¹é»: æä¾›å° LLM å…§éƒ¨æ±ºç­–éç¨‹æœ€ç´°ç·»çš„æ§åˆ¶å’Œåˆ†æï¼Œä½†å¯¦ä½œè¤‡é›œåº¦é«˜ï¼Œéœ€è¦æ·±å…¥ç†è§£æ¨¡å‹æ¶æ§‹ã€‚&lt;/li&gt;
&lt;li&gt;ç¨‹å¼ç¢¼ç¯„ä¾‹:
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-python" data-lang="python"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;import&lt;/span&gt; torch
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#f92672"&gt;from&lt;/span&gt; transformers &lt;span style="color:#f92672"&gt;import&lt;/span&gt; AutoModelForCausalLM, AutoTokenizer
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;def&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;get_inputs&lt;/span&gt;(pairs, tokenizer, prompt&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#66d9ef"&gt;None&lt;/span&gt;, max_length&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;1024&lt;/span&gt;):
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;if&lt;/span&gt; prompt &lt;span style="color:#f92672"&gt;is&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;None&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; prompt &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;Given a query A and a passage B, determine whether the passage contains an answer to the query by providing a prediction of either &amp;#39;Yes&amp;#39; or &amp;#39;No&amp;#39;.&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; sep &lt;span style="color:#f92672"&gt;=&lt;/span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;\n&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; prompt_inputs &lt;span style="color:#f92672"&gt;=&lt;/span&gt; tokenizer(prompt,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; return_tensors&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#66d9ef"&gt;None&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; add_special_tokens&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#66d9ef"&gt;False&lt;/span&gt;)[&lt;span style="color:#e6db74"&gt;&amp;#39;input_ids&amp;#39;&lt;/span&gt;]
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; sep_inputs &lt;span style="color:#f92672"&gt;=&lt;/span&gt; tokenizer(sep,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; return_tensors&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#66d9ef"&gt;None&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; add_special_tokens&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#66d9ef"&gt;False&lt;/span&gt;)[&lt;span style="color:#e6db74"&gt;&amp;#39;input_ids&amp;#39;&lt;/span&gt;]
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; inputs &lt;span style="color:#f92672"&gt;=&lt;/span&gt; []
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;for&lt;/span&gt; query, passage &lt;span style="color:#f92672"&gt;in&lt;/span&gt; pairs:
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; query_inputs &lt;span style="color:#f92672"&gt;=&lt;/span&gt; tokenizer(&lt;span style="color:#e6db74"&gt;f&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#39;A: &lt;/span&gt;&lt;span style="color:#e6db74"&gt;{&lt;/span&gt;query&lt;span style="color:#e6db74"&gt;}&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; return_tensors&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#66d9ef"&gt;None&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; add_special_tokens&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#66d9ef"&gt;False&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; max_length&lt;span style="color:#f92672"&gt;=&lt;/span&gt;max_length &lt;span style="color:#f92672"&gt;*&lt;/span&gt; &lt;span style="color:#ae81ff"&gt;3&lt;/span&gt; &lt;span style="color:#f92672"&gt;//&lt;/span&gt; &lt;span style="color:#ae81ff"&gt;4&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; truncation&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#66d9ef"&gt;True&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; passage_inputs &lt;span style="color:#f92672"&gt;=&lt;/span&gt; tokenizer(&lt;span style="color:#e6db74"&gt;f&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#39;B: &lt;/span&gt;&lt;span style="color:#e6db74"&gt;{&lt;/span&gt;passage&lt;span style="color:#e6db74"&gt;}&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; return_tensors&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#66d9ef"&gt;None&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; add_special_tokens&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#66d9ef"&gt;False&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; max_length&lt;span style="color:#f92672"&gt;=&lt;/span&gt;max_length,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; truncation&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#66d9ef"&gt;True&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; item &lt;span style="color:#f92672"&gt;=&lt;/span&gt; tokenizer&lt;span style="color:#f92672"&gt;.&lt;/span&gt;prepare_for_model(
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; [tokenizer&lt;span style="color:#f92672"&gt;.&lt;/span&gt;bos_token_id] &lt;span style="color:#f92672"&gt;+&lt;/span&gt; query_inputs[&lt;span style="color:#e6db74"&gt;&amp;#39;input_ids&amp;#39;&lt;/span&gt;],
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; sep_inputs &lt;span style="color:#f92672"&gt;+&lt;/span&gt; passage_inputs[&lt;span style="color:#e6db74"&gt;&amp;#39;input_ids&amp;#39;&lt;/span&gt;],
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; truncation&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#39;only_second&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; max_length&lt;span style="color:#f92672"&gt;=&lt;/span&gt;max_length,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; padding&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#66d9ef"&gt;False&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; return_attention_mask&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#66d9ef"&gt;False&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; return_token_type_ids&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#66d9ef"&gt;False&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; add_special_tokens&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#66d9ef"&gt;False&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; )
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; item[&lt;span style="color:#e6db74"&gt;&amp;#39;input_ids&amp;#39;&lt;/span&gt;] &lt;span style="color:#f92672"&gt;=&lt;/span&gt; item[&lt;span style="color:#e6db74"&gt;&amp;#39;input_ids&amp;#39;&lt;/span&gt;] &lt;span style="color:#f92672"&gt;+&lt;/span&gt; sep_inputs &lt;span style="color:#f92672"&gt;+&lt;/span&gt; prompt_inputs
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; item[&lt;span style="color:#e6db74"&gt;&amp;#39;attention_mask&amp;#39;&lt;/span&gt;] &lt;span style="color:#f92672"&gt;=&lt;/span&gt; [&lt;span style="color:#ae81ff"&gt;1&lt;/span&gt;] &lt;span style="color:#f92672"&gt;*&lt;/span&gt; len(item[&lt;span style="color:#e6db74"&gt;&amp;#39;input_ids&amp;#39;&lt;/span&gt;])
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; inputs&lt;span style="color:#f92672"&gt;.&lt;/span&gt;append(item)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;return&lt;/span&gt; tokenizer&lt;span style="color:#f92672"&gt;.&lt;/span&gt;pad(
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; inputs,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; padding&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#66d9ef"&gt;True&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; max_length&lt;span style="color:#f92672"&gt;=&lt;/span&gt;max_length &lt;span style="color:#f92672"&gt;+&lt;/span&gt; len(sep_inputs) &lt;span style="color:#f92672"&gt;+&lt;/span&gt; len(prompt_inputs),
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; pad_to_multiple_of&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;8&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; return_tensors&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#e6db74"&gt;&amp;#39;pt&amp;#39;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; )
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;tokenizer &lt;span style="color:#f92672"&gt;=&lt;/span&gt; AutoTokenizer&lt;span style="color:#f92672"&gt;.&lt;/span&gt;from_pretrained(&lt;span style="color:#e6db74"&gt;&amp;#39;BAAI/bge-reranker-v2-minicpm-layerwise&amp;#39;&lt;/span&gt;, trust_remote_code&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#66d9ef"&gt;True&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;model &lt;span style="color:#f92672"&gt;=&lt;/span&gt; AutoModelForCausalLM&lt;span style="color:#f92672"&gt;.&lt;/span&gt;from_pretrained(&lt;span style="color:#e6db74"&gt;&amp;#39;BAAI/bge-reranker-v2-minicpm-layerwise&amp;#39;&lt;/span&gt;, trust_remote_code&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#66d9ef"&gt;True&lt;/span&gt;, torch_dtype&lt;span style="color:#f92672"&gt;=&lt;/span&gt;torch&lt;span style="color:#f92672"&gt;.&lt;/span&gt;bfloat16)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;model &lt;span style="color:#f92672"&gt;=&lt;/span&gt; model&lt;span style="color:#f92672"&gt;.&lt;/span&gt;to(&lt;span style="color:#e6db74"&gt;&amp;#39;cuda&amp;#39;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;model&lt;span style="color:#f92672"&gt;.&lt;/span&gt;eval()
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;pairs &lt;span style="color:#f92672"&gt;=&lt;/span&gt; [[&lt;span style="color:#e6db74"&gt;&amp;#39;what is panda?&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;hi&amp;#39;&lt;/span&gt;], [&lt;span style="color:#e6db74"&gt;&amp;#39;what is panda?&amp;#39;&lt;/span&gt;, &lt;span style="color:#e6db74"&gt;&amp;#39;The giant panda (Ailuropoda melanoleuca), sometimes called a panda bear or simply panda, is a bear species endemic to China.&amp;#39;&lt;/span&gt;]]
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;with&lt;/span&gt; torch&lt;span style="color:#f92672"&gt;.&lt;/span&gt;no_grad():
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; inputs &lt;span style="color:#f92672"&gt;=&lt;/span&gt; get_inputs(pairs, tokenizer)&lt;span style="color:#f92672"&gt;.&lt;/span&gt;to(model&lt;span style="color:#f92672"&gt;.&lt;/span&gt;device)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; all_scores &lt;span style="color:#f92672"&gt;=&lt;/span&gt; model(&lt;span style="color:#f92672"&gt;**&lt;/span&gt;inputs, return_dict&lt;span style="color:#f92672"&gt;=&lt;/span&gt;&lt;span style="color:#66d9ef"&gt;True&lt;/span&gt;, cutoff_layers&lt;span style="color:#f92672"&gt;=&lt;/span&gt;[&lt;span style="color:#ae81ff"&gt;28&lt;/span&gt;])
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; all_scores &lt;span style="color:#f92672"&gt;=&lt;/span&gt; [scores[:, &lt;span style="color:#f92672"&gt;-&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;1&lt;/span&gt;]&lt;span style="color:#f92672"&gt;.&lt;/span&gt;view(&lt;span style="color:#f92672"&gt;-&lt;/span&gt;&lt;span style="color:#ae81ff"&gt;1&lt;/span&gt;, )&lt;span style="color:#f92672"&gt;.&lt;/span&gt;float() &lt;span style="color:#66d9ef"&gt;for&lt;/span&gt; scores &lt;span style="color:#f92672"&gt;in&lt;/span&gt; all_scores[&lt;span style="color:#ae81ff"&gt;0&lt;/span&gt;]]
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; print(all_scores)
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id="æ ¸å¿ƒæ¦‚å¿µè§£æ"&gt;æ ¸å¿ƒæ¦‚å¿µè§£æ
&lt;/h3&gt;&lt;h4 id="æ¨™æº–-reranker-cross-encoder"&gt;æ¨™æº– Reranker (Cross-Encoder)
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;åŸç†: å°‡ã€ŒæŸ¥è©¢ã€å’Œã€Œæ–‡ä»¶ã€æˆå°åœ°åŒæ™‚è¼¸å…¥åˆ°æ¨¡å‹ä¸­ï¼Œæ¨¡å‹åˆ©ç”¨å…©è€…ä¹‹é–“çš„äº¤äº’è³‡è¨Šåˆ¤æ–·ç›¸é—œæ€§ã€‚&lt;/li&gt;
&lt;li&gt;è¼¸å‡º: å–®ä¸€ç›¸é—œæ€§åˆ†æ•¸ã€‚&lt;/li&gt;
&lt;li&gt;æµç¨‹: æŸ¥è©¢ + æ–‡ä»¶ â†’ Cross-Encoder æ¨¡å‹ â†’ ç›¸é—œæ€§åˆ†æ•¸&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="llm-based-reranker"&gt;LLM-based Reranker
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;åŸç†: ä½¿ç”¨å®Œæ•´çš„å¤§å‹èªè¨€æ¨¡å‹ï¼ˆLLMï¼‰ä½œç‚º Rerankerï¼Œåˆ©ç”¨å…¶é¾å¤§çŸ¥è­˜å’Œæ¨ç†èƒ½åŠ›ç†è§£æ·±å±¤èªç¾©é—œä¿‚ã€‚&lt;/li&gt;
&lt;li&gt;è¼¸å‡º: é€šå¸¸é€éç‰¹å®š tokenï¼ˆå¦‚ [Yes] æˆ– [No]ï¼‰çš„æ©Ÿç‡è¨ˆç®—åˆ†æ•¸ã€‚&lt;/li&gt;
&lt;li&gt;æµç¨‹: æŸ¥è©¢ + æ–‡ä»¶ â†’ å¤§å‹èªè¨€æ¨¡å‹ (LLM) â†’ åŸºæ–¼ç”Ÿæˆæ©Ÿç‡çš„åˆ†æ•¸&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="ç¸½çµèˆ‡æ¯”è¼ƒ"&gt;ç¸½çµèˆ‡æ¯”è¼ƒ
&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;æ¯”è¼ƒç¶­åº¦&lt;/th&gt;
&lt;th&gt;FlagEmbedding&lt;/th&gt;
&lt;th&gt;Hugging Face Transformers&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;æ˜“ç”¨æ€§&lt;/td&gt;
&lt;td&gt;é«˜ï¼ˆAPI å°è£è‰¯å¥½ï¼‰&lt;/td&gt;
&lt;td&gt;ä¸­ï¼ˆéœ€è¦æ›´å¤šæ‰‹å‹•è¨­å®šï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;éˆæ´»æ€§&lt;/td&gt;
&lt;td&gt;ä¸­ï¼ˆå°ˆç‚º Reranking å„ªåŒ–ï¼‰&lt;/td&gt;
&lt;td&gt;é«˜ï¼ˆå¯å®Œå…¨è‡ªè¨‚æµç¨‹ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ç‰¹è‰²åŠŸèƒ½&lt;/td&gt;
&lt;td&gt;Layerwise åˆ†æ•¸è¨ˆç®—&lt;/td&gt;
&lt;td&gt;èˆ‡æ•´å€‹ Hugging Face ç”Ÿæ…‹ç³»ç„¡ç¸«æ¥è»Œ&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æ¨è–¦ä½¿ç”¨æƒ…å¢ƒ&lt;/td&gt;
&lt;td&gt;éœ€è¦å¿«é€Ÿå¯¦ç¾é«˜æ•ˆèƒ½ Reranking çš„æ‡‰ç”¨&lt;/td&gt;
&lt;td&gt;éœ€è¦æ·±åº¦è‡ªè¨‚æ¨¡å‹è¡Œç‚ºæˆ–é€²è¡Œå­¸è¡“ç ”ç©¶&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;</description></item><item><title>ä¸‰ç¨® RAG æ¶æ§‹æ¯”è¼ƒèˆ‡æ‡‰ç”¨è§£æ â€” Naiveã€Advancedã€Modular RAG å·®ç•°æ•´ç†</title><link>https://Dandelionlibra.github.io/post/note/rag-type-compare-note/</link><pubDate>Mon, 21 Jul 2025 09:16:00 +0800</pubDate><guid>https://Dandelionlibra.github.io/post/note/rag-type-compare-note/</guid><description>&lt;h1 id="ä¸‰ç¨®-rag-æŠ€è¡“æ¶æ§‹æ¯”è¼ƒnaive-ragadvanced-rag-èˆ‡-modular-rag"&gt;ä¸‰ç¨® RAG æŠ€è¡“æ¶æ§‹æ¯”è¼ƒï¼šNaive RAGã€Advanced RAG èˆ‡ Modular RAG
&lt;/h1&gt;&lt;p&gt;æœ¬æ–‡æ¯”è¼ƒã€ŠRetrieval-Augmented Generation for Large Language Models: A Surveyã€‹ä¸­æå‡ºçš„ä¸‰ç¨®æª¢ç´¢å¢å¼·ç”Ÿæˆï¼ˆRAGï¼‰æŠ€è¡“æ¶æ§‹ï¼šNaive RAGã€Advanced RAG å’Œ Modular RAGã€‚RAG æ—¨åœ¨çµåˆå¤§å‹èªè¨€æ¨¡å‹ï¼ˆLLMï¼‰çš„å…§éƒ¨çŸ¥è­˜èˆ‡å¤–éƒ¨è³‡æ–™æª¢ç´¢ï¼Œä»¥æå‡äº‹å¯¦æ­£ç¢ºæ€§èˆ‡æ™‚æ•ˆæ€§ã€‚é€™ä¸‰ç¨®æ¶æ§‹ä»£è¡¨äº† RAG æŠ€è¡“çš„æ¼”é€²è·¯å¾‘ï¼Œå„è‡ªå¼•å…¥ä¸åŒæ¨¡çµ„èˆ‡ç­–ç•¥ä¾†å…‹æœå…ˆå‰æ¶æ§‹çš„ä¾·é™ã€‚æœ¬æ–‡å°‡å¾æ¶æ§‹çµ„æˆã€å¯¦ä½œæ–¹å¼ã€æŠ€è¡“ç´°ç¯€ã€æ‡‰ç”¨å ´æ™¯èˆ‡å„ªåŠ£æ¯”è¼ƒç­‰é¢å‘ï¼Œæ·±å…¥å‰–æä¸‰é¡æ¶æ§‹çš„å·®ç•°èˆ‡é©ç”¨æ€§ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id="æ¶æ§‹çµ„æˆèˆ‡æµç¨‹å·®ç•°"&gt;æ¶æ§‹çµ„æˆèˆ‡æµç¨‹å·®ç•°
&lt;/h2&gt;&lt;h3 id="naive-rag"&gt;Naive RAG
&lt;/h3&gt;&lt;p&gt;æœ€æ—©æœŸä¸”åŸºç¤çš„ RAG æ¶æ§‹ï¼Œåƒ…åŒ…å«ç´¢å¼•ï¼ˆIndexingï¼‰ã€æª¢ç´¢ï¼ˆRetrievalï¼‰èˆ‡ç”Ÿæˆï¼ˆGenerationï¼‰ä¸‰å€‹ä¸²é€£æ¨¡çµ„ã€‚æµç¨‹ç‚ºï¼šè³‡æ–™å‘é‡åŒ– â†’ æª¢ç´¢å‰ $K$ å€‹ç›¸é—œç‰‡æ®µ â†’ æŸ¥è©¢èˆ‡æª¢ç´¢çµæœä¸€ä½µé¤µçµ¦ LLM ç”¢ç”Ÿå›ç­”ã€‚æ­¤æ¶æ§‹æµç¨‹ç°¡å–®ã€æ¨¡çµ„å–®ä¸€ï¼Œç¼ºä¹æŸ¥è©¢å„ªåŒ–æˆ–åé¥‹æ©Ÿåˆ¶ï¼Œé©åˆå¿«é€ŸåŸå‹é–‹ç™¼ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://www.ibm.com/content/dam/connectedassets-adobe-cms/worldwide-content/creative-assets/s-migr/ul/g/e0/d6/naive-rag.png"
loading="lazy"
alt="Naive RAG æ¶æ§‹åœ–"
&gt;&lt;/p&gt;
&lt;h3 id="advanced-rag"&gt;Advanced RAG
&lt;/h3&gt;&lt;p&gt;åœ¨ Naive åŸºç¤ä¸Šå¢åŠ å‰è™•ç†èˆ‡å¾Œè™•ç†æ¨¡çµ„ï¼Œå¦‚æŸ¥è©¢å„ªåŒ–ã€é‡æ’åºã€å…§å®¹éæ¿¾/å£“ç¸®ç­‰ã€‚æµç¨‹ä»ç‚ºç´¢å¼•â†’æª¢ç´¢â†’ç”Ÿæˆï¼Œä½†åœ¨æª¢ç´¢å‰å¾Œæ’å…¥å„ªåŒ–æ­¥é©Ÿï¼Œæå‡æª¢ç´¢å“è³ªèˆ‡ç”Ÿæˆç›¸é—œæ€§ã€‚çµ„ä»¶åŒ…å«æŸ¥è©¢æ”¹å¯«ã€æ··åˆæª¢ç´¢ã€é‡æ’åºç­‰ï¼Œèƒ½é‡å°æ€§å¼·åŒ–æª¢ç´¢èˆ‡ç”Ÿæˆéšæ®µã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://www.ibm.com/content/dam/connectedassets-adobe-cms/worldwide-content/creative-assets/s-migr/ul/g/8f/cb/advances-rag.png"
loading="lazy"
alt="Advanced RAG æ¶æ§‹åœ–"
&gt;&lt;/p&gt;
&lt;h3 id="modular-rag"&gt;Modular RAG
&lt;/h3&gt;&lt;p&gt;æœ€æ–°éšæ®µï¼Œå¼·èª¿ç©æœ¨å¼æ¨¡çµ„åŒ–è¨­è¨ˆã€‚é™¤ç¹¼æ‰¿å‰è¿°æµç¨‹å¤–ï¼Œå…è¨±å¤šè¼ªæª¢ç´¢-ç”Ÿæˆã€å¹³è¡Œè³‡è¨Šèåˆã€è‡ªé©æ‡‰æµç¨‹ç­‰ã€‚å¯éˆæ´»å¢æ¸›å¦‚ç¶²è·¯æœå°‹ã€é•·ç¨‹è¨˜æ†¶ã€è·¯ç”±æ±ºç­–ç­‰æ¨¡çµ„ï¼Œæµç¨‹å¯é‡çµ„ã€è¿­ä»£æˆ–åˆ†æ”¯ï¼Œé©æ‡‰è¤‡é›œå¤šè®Šçš„ä»»å‹™éœ€æ±‚ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src="https://www.ibm.com/content/dam/connectedassets-adobe-cms/worldwide-content/creative-assets/s-migr/ul/g/a7/e6/modular-rag.component.crop-16by9-m.ts=1740501066286.png/content/adobe-cms/us/en/think/topics/rag-techniques/jcr:content/root/table_of_contents/body-article-8/image_1228195012"
loading="lazy"
alt="Modular RAG æ¶æ§‹åœ–"
&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id="å¯¦ä½œæ–¹å¼èˆ‡ç³»çµ±ç‰¹æ€§"&gt;å¯¦ä½œæ–¹å¼èˆ‡ç³»çµ±ç‰¹æ€§
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Naive RAG&lt;/strong&gt;ï¼šå¯¦ä½œæœ€ç›´æ¥ï¼Œåƒ…éœ€åµŒå…¥æ¨¡å‹ã€å‘é‡è³‡æ–™åº«èˆ‡ LLMã€‚æ¨¡çµ„ç·šæ€§ä¸²æ¥ï¼Œç„¡éœ€å¾®èª¿ï¼Œéƒ¨ç½²ç¶­è­·æˆæœ¬ä½ï¼Œé©åˆç°¡å–®æ‡‰ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Advanced RAG&lt;/strong&gt;ï¼šéœ€å¼•å…¥æŸ¥è©¢å„ªåŒ–ã€é‡æ’åºç­‰æ¨¡çµ„ï¼Œå¸¸ç”¨ LlamaIndexã€LangChain ç­‰æ¡†æ¶ã€‚ç³»çµ±è¤‡é›œåº¦æå‡ï¼Œéœ€èª¿æ ¡å¤šå€‹å­ç³»çµ±ï¼Œé©åˆä¸­ç­‰è¤‡é›œåº¦ä»»å‹™ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Modular RAG&lt;/strong&gt;ï¼šé«˜åº¦æ¨¡çµ„åŒ–ï¼Œå¸¸ç”¨æµæ°´ç·šç·¨æ’æ¡†æ¶ã€‚æ¯å€‹åŠŸèƒ½ç¨ç«‹å°è£ï¼Œç³»çµ±å¯ç‚ºæœ‰å‘åœ–çµæ§‹ï¼Œä¾¿æ–¼æ“´å……èˆ‡ç¶­è­·ï¼Œä½†é–‹ç™¼å”èª¿æˆæœ¬é«˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id="æ ¸å¿ƒæŠ€è¡“ç´°ç¯€"&gt;æ ¸å¿ƒæŠ€è¡“ç´°ç¯€
&lt;/h2&gt;&lt;h3 id="è³‡æ–™é è™•ç†èˆ‡åµŒå…¥"&gt;è³‡æ–™é è™•ç†èˆ‡åµŒå…¥
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Naive RAG&lt;/strong&gt;ï¼šæ–‡æœ¬æ¸…æ´—ã€åˆ‡åˆ†ã€åµŒå…¥ï¼Œå»ºç«‹å‘é‡ç´¢å¼•ï¼Œé‡é»åœ¨èªç¾©è¡¨ç¤ºã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Advanced RAG&lt;/strong&gt;ï¼šç´°ç²’åº¦åˆ‡åˆ†ã€æ»‘å‹•è¦–çª—ã€metadata æ¨™è¨»ã€æ··åˆåµŒå…¥ï¼ˆå¯†é›†+ç¨€ç–ï¼‰ï¼Œæå‡æª¢ç´¢è¦†è“‹ç‡èˆ‡ç²¾ç¢ºæ€§ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Modular RAG&lt;/strong&gt;ï¼šå‹•æ…‹è³‡æ–™è™•ç†ï¼Œå¯å³æ™‚æŠ“å–æ–°è³‡æ–™ã€å¤šæ¨¡æ…‹è³‡æ–™ã€è¨˜æ†¶æ¨¡çµ„è‡ªæˆ‘å¢å¼·ï¼ŒåµŒå…¥ç­–ç•¥å¤šå…ƒä¸”å¯æ¼”åŒ–ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="æª¢ç´¢ç­–ç•¥èˆ‡æŸ¥è©¢å„ªåŒ–"&gt;æª¢ç´¢ç­–ç•¥èˆ‡æŸ¥è©¢å„ªåŒ–
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Naive RAG&lt;/strong&gt;ï¼šå–®è¼ªèªç¾©ç›¸ä¼¼åº¦æª¢ç´¢ï¼Œç„¡æŸ¥è©¢å„ªåŒ–æˆ–å¤šè¼ªäº¤äº’ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Advanced RAG&lt;/strong&gt;ï¼šæŸ¥è©¢é‡å¯«/æ“´å±•ã€å¤šæ¬¡/æ··åˆæª¢ç´¢ã€é‡æ’åºèˆ‡éæ¿¾ï¼Œæå‡æª¢ç´¢æº–ç¢ºç‡èˆ‡è¦†è“‹ç‡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Modular RAG&lt;/strong&gt;ï¼šè‡ªé©æ‡‰å¤šéšæ®µæª¢ç´¢ã€è·¯ç”±æ±ºç­–ã€å¹³è¡Œå¤šæŸ¥è©¢ã€éæ­¸å¼æª¢ç´¢ï¼Œæ ¹æ“šä»»å‹™å‹•æ…‹èª¿åº¦æª¢ç´¢ç­–ç•¥ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="ä¸Šä¸‹æ–‡èåˆèˆ‡è³‡è¨Šå¢å¼·"&gt;ä¸Šä¸‹æ–‡èåˆèˆ‡è³‡è¨Šå¢å¼·
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Naive RAG&lt;/strong&gt;ï¼šç›´æ¥æ‹¼æ¥æŸ¥è©¢èˆ‡æª¢ç´¢å…§å®¹ï¼Œç„¡é¡å¤–è™•ç†ï¼Œæ˜“å—é›œè¨Šå¹²æ“¾ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Advanced RAG&lt;/strong&gt;ï¼šé‡æ’åºã€å£“ç¸®ã€éæ¿¾ã€æ˜ç¢ºå¼•å°æ¨¡å‹å¼•ç”¨æª¢ç´¢å…§å®¹ï¼Œæå‡è¨Šæ¯å“è³ªã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Modular RAG&lt;/strong&gt;ï¼šå¤šæ­¥èåˆã€ç¤ºç¯„-æœç´¢-é æ¸¬ã€å‹•æ…‹è¨˜æ†¶ã€äº‹å¾Œæ ¡é©—ï¼Œæ·±åº¦æ•´åˆå¤–éƒ¨çŸ¥è­˜èˆ‡æ¨¡å‹æ¨ç†ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="å›ç­”ç”Ÿæˆèˆ‡æ§åˆ¶"&gt;å›ç­”ç”Ÿæˆèˆ‡æ§åˆ¶
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Naive RAG&lt;/strong&gt;ï¼šLLM ç›´æ¥ç”Ÿæˆï¼Œæ§åˆ¶åŠ›å¼±ï¼Œæ˜“å‡ºç¾å¹»è¦ºæˆ–æ‹¼è²¼ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Advanced RAG&lt;/strong&gt;ï¼šæç¤ºå·¥ç¨‹ã€å¾®èª¿ã€åé¥‹è¿´è·¯ã€ç”Ÿæˆå¾Œéæ¿¾ï¼Œå¼·åŒ–å¯é æ€§èˆ‡å®‰å…¨æ€§ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Modular RAG&lt;/strong&gt;ï¼šç¤ºç¯„æ¨¡çµ„ã€è¿­ä»£ç”Ÿæˆã€å¾Œè™•ç†æ ¡é©—ã€ç”¨æˆ¶åé¥‹è¿´è·¯ï¼Œå¯¦ç¾åš´è¬¹çš„ç”Ÿæˆç®¡æ§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id="é©ç”¨å ´æ™¯èˆ‡é™åˆ¶"&gt;é©ç”¨å ´æ™¯èˆ‡é™åˆ¶
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Naive RAG&lt;/strong&gt;ï¼šé©åˆåŸå‹ã€FAQã€å…§éƒ¨çŸ¥è­˜åº«ç­‰ä½è¤‡é›œåº¦å ´æ™¯ï¼Œé–‹ç™¼å¿«ä½†ä¸é©åˆé«˜ç²¾åº¦æˆ–å¤šæ­¥æ¨ç†ä»»å‹™ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Advanced RAG&lt;/strong&gt;ï¼šé©ç”¨æ–¼é†«ç™‚ã€æ³•å¾‹ã€æ•™è‚²ç­‰çŸ¥è­˜å¯†é›†å‹å•ç­”ï¼Œèƒ½è™•ç†è¼ƒå¤§è¦æ¨¡çŸ¥è­˜åº«ï¼Œä½†è³‡æºéœ€æ±‚èˆ‡ç¶­è­·æˆæœ¬è¼ƒé«˜ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Modular RAG&lt;/strong&gt;ï¼šé©åˆå¤§å‹ä¼æ¥­ã€è·¨é ˜åŸŸç³»çµ±ã€éœ€å¤šéšæ®µæ¨ç†æˆ–å¤šæºè³‡è¨Šæ•´åˆçš„å ´æ™¯ï¼Œæ“´å±•æ€§èˆ‡ç¶­è­·æ€§æœ€ä½³ï¼Œä½†é–‹ç™¼è¤‡é›œåº¦èˆ‡åˆå§‹æˆæœ¬é«˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id="å„ªåŠ£æ¯”è¼ƒ"&gt;å„ªåŠ£æ¯”è¼ƒ
&lt;/h2&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;æ¶æ§‹&lt;/th&gt;
&lt;th&gt;å¯¦ç”¨æ€§&lt;/th&gt;
&lt;th&gt;å¯æ“´å±•æ€§&lt;/th&gt;
&lt;th&gt;ç¶­è­·æˆæœ¬&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Naive RAG&lt;/td&gt;
&lt;td&gt;é«˜ï¼ˆæ˜“ç”¨ï¼‰&lt;/td&gt;
&lt;td&gt;ä½ï½ä¸­&lt;/td&gt;
&lt;td&gt;ä½&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Advanced RAG&lt;/td&gt;
&lt;td&gt;ä¸­ï¼ˆéœ€å°ˆæ¥­ï¼‰&lt;/td&gt;
&lt;td&gt;ä¸­ï½é«˜&lt;/td&gt;
&lt;td&gt;ä¸­&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Modular RAG&lt;/td&gt;
&lt;td&gt;ä½ï¼ˆè¤‡é›œï¼‰&lt;/td&gt;
&lt;td&gt;æ¥µé«˜&lt;/td&gt;
&lt;td&gt;é«˜ï¼ˆåˆå§‹ï¼‰ï¼Œä½ï¼ˆå±€éƒ¨ç¶­è­·ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Naive RAG&lt;/strong&gt;ï¼šç°¡å–®æ˜“ç”¨ã€æˆæœ¬ä½ï¼Œä½†é‡åˆ°è¤‡é›œä»»å‹™æ˜“é”å¤©èŠ±æ¿ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Advanced RAG&lt;/strong&gt;ï¼šæ€§èƒ½èˆ‡è¤‡é›œåº¦å¹³è¡¡ï¼Œé©åˆå¤šæ•¸å°ˆæ¥­æ‡‰ç”¨ï¼Œç¶­è­·éœ€å°ˆæ¥­æŠ•å…¥ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Modular RAG&lt;/strong&gt;ï¼šå½ˆæ€§èˆ‡æ“´å±•æ€§æœ€å¼·ï¼Œé©åˆé«˜ç«¯éœ€æ±‚ï¼Œä½†é–‹ç™¼èˆ‡å”èª¿æˆæœ¬é«˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h2 id="çµè«–"&gt;çµè«–
&lt;/h2&gt;&lt;p&gt;ä¸‰ç¨® RAG æ¶æ§‹å„æœ‰é©ç”¨å ´æ™¯èˆ‡å„ªåŠ£ã€‚Naive RAG é©åˆå¿«é€ŸåŸå‹èˆ‡ç°¡å–®æ‡‰ç”¨ï¼ŒAdvanced RAG é©åˆå°ˆæ¥­é ˜åŸŸèˆ‡ä¸­å¤§å‹çŸ¥è­˜åº«ï¼ŒModular RAG å‰‡ç‚ºé«˜è¤‡é›œåº¦ã€éœ€é•·æœŸæ¼”åŒ–çš„ç³»çµ±æä¾›æœ€ä½³è§£æ±ºæ–¹æ¡ˆã€‚é¸æ“‡ä½•ç¨®æ¶æ§‹ï¼Œæ‡‰æ ¹æ“šå¯¦éš›éœ€æ±‚ã€è³‡æºèˆ‡é•·æœŸç¶­è­·è€ƒé‡æ¬Šè¡¡å–æ¨ã€‚&lt;/p&gt;
&lt;h2 id="reference"&gt;Reference
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a class="link" href="https://arxiv.org/abs/2312.10997" target="_blank" rel="noopener"
&gt;Retrieval-Augmented Generation for Large Language Models: A Survey&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="link" href="https://www.thecloudgirl.dev/blog/three-paradigms-of-retrieval-augmented-generation-rag-for-llms#:~:text=,on%20embeddings%20from%20language%20models" target="_blank" rel="noopener"
&gt;Three Paradigms of Retrieval-Augmented Generation (RAG) for LLMs&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="link" href="https://www.ibm.com/think/topics/rag-techniques#:~:" target="_blank" rel="noopener"
&gt;RAG Techniques | IBM Think&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</description></item><item><title>å¾®è¡¨æƒ…(Micro Facial Expression)</title><link>https://Dandelionlibra.github.io/post/note/micro_facial_expression/</link><pubDate>Sun, 20 Oct 2024 00:00:00 +0000</pubDate><guid>https://Dandelionlibra.github.io/post/note/micro_facial_expression/</guid><description>&lt;img src="https://Dandelionlibra.github.io/unsplash.jpg" alt="Featured image of post å¾®è¡¨æƒ…(Micro Facial Expression)" /&gt;&lt;h2 id="è‡‰éƒ¨è¡¨æƒ…ç¨®é¡"&gt;è‡‰éƒ¨è¡¨æƒ…ç¨®é¡
&lt;/h2&gt;&lt;p&gt;&lt;a class="link" href="https://zh.wikipedia.org/zh-tw/%E4%BF%9D%E7%BD%97%C2%B7%E8%89%BE%E5%85%8B%E6%9B%BC" target="_blank" rel="noopener"
&gt;ä¿ç¾…Â·è‰¾å…‹æ›¼&lt;/a&gt;ï¼ˆPaul Ekmanï¼‰å¾1970å¹´ä»£ä»¥ä¾†çš„ç ”ç©¶ï¼ŒæŠŠè‡‰éƒ¨å¾®è¡¨æƒ…åˆ†æˆï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¿«æ¨‚(happy)&lt;/li&gt;
&lt;li&gt;æ‚²å‚·(sad)&lt;/li&gt;
&lt;li&gt;ç”Ÿæ°£(angry)&lt;/li&gt;
&lt;li&gt;é©šè¨(surprised)&lt;/li&gt;
&lt;li&gt;å®³æ€•(scared)&lt;/li&gt;
&lt;li&gt;å­æƒ¡(disgusted)&lt;/li&gt;
&lt;li&gt;é„™è¦–(contempt)&lt;/li&gt;
&lt;li&gt;ä¸­æ€§(neutral)&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="å¾®è¡¨æƒ…æ‡‰ç”¨"&gt;å¾®è¡¨æƒ…æ‡‰ç”¨
&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;è‡ºå¸«å¤§é‚±ç¾è™¹ï¼šã€Œæˆ‘å¸Œæœ›ç”¨æ–°èˆˆç§‘æŠ€æ‰¾åˆ°å­¸ç”Ÿåœ¨å­¸ç¿’ç§‘å­¸çŸ¥è­˜æ™‚çš„é›£é»ï¼Œæ”¹å–„ç§‘å­¸å­¸ç¿’æ™‚çš„å›°å¢ƒã€‚è€Œå…¶ä¸­çš„ä¸€æ­¥ï¼Œå°±æ˜¯ç”¨è¾¨è­˜å¾®è¡¨æƒ…çš„AIç³»çµ±ï¼Œæ‰¾å‡ºå­¸ç”Ÿé¢å°éé æœŸçš„ç§‘å­¸ç¾è±¡å’Œå¤šé‡è¡¨å¾µçš„è§£é‡‹æ‰€å‡ºç¾çš„æŸäº›ç‰¹å®šå¾®è¡¨æƒ…æ™‚æ‰€ä»£è¡¨çš„æ„ç¾©ï¼Œä»¥ç­è§£å­¸ç”Ÿé¢å°é€™äº›æƒ…æ³æ™‚çš„åæ‡‰èˆ‡æ•ˆç›Šï¼Œä»¥ä¾¿è¨­è¨ˆæœ‰æ„ç¾©çš„å­¸ç¿’å’Œæ•™å­¸ç­–ç•¥ã€‚ã€&lt;br&gt;
&lt;a class="link" href="https://humanityisland.nccu.edu.tw/qiumeihong_a/" target="_blank" rel="noopener"
&gt;æ–‡ç« å ±å°&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;è¿ªå£«å°¼ç ”ç©¶ä¸­å¿ƒ(FVAE â€“ æ·±åº¦å­¸ç¿’è§€çœ¾è¡¨æƒ…ï¼Œå®‰æ’åŠ‡æƒ…èµ°å‘)ï¼Œåœ¨é»‘æš—çš„å½±å»³å…§è§€å¯Ÿè§€çœ¾çš„è‡‰éƒ¨è¡¨æƒ…ï¼Œä¸¦å­¸ç¿’åˆ†è¾¨å¾®ç¬‘ã€å¤§ç¬‘ç­‰ä¸åŒç¨‹åº¦çš„æƒ…ç·’ã€‚é€™æ¨£çš„ç¥ç¶“ç¶²çµ¡å­¸ç¿’ï¼Œä¸åªè¦èª¿æŸ¥ä½ æœ‰å¤šå–œæ­¡ç•¶ä¸‹çš„åŠ‡æƒ…ï¼Œæ›´è¦é æ¸¬ä½ æ˜¯å¦å¯èƒ½å–œæ­¡æ¥ä¸‹ä¾†çš„èµ°å‘ï¼Œå®ƒèƒ½æ ¹æ“šéå»å­¸ç¿’çš„çµæœï¼Œåœ¨é–‹æ¼”çš„å‰ååˆ†é˜å°±é æ¸¬è§€çœ¾ä¹‹å¾Œçš„æƒ…ç·’ï¼&lt;br&gt;
&lt;a class="link" href="https://mile.cloud/zh/resources/blog/facial-detection-technology-is-popular-quantifying-micro-expressions-into-big-data_39" target="_blank" rel="noopener"
&gt;æ–‡ç« å ±å°&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;å°‡å¾®è¡¨æƒ…æ‡‰ç”¨æ–¼é¢è©¦ä¸Šï¼Œä¹Ÿèƒ½æº–ç¢ºæŠ“å‡ºæ‡‰å¾µè€…çš„è·å ´æ€§æ ¼èˆ‡æºé€šèƒ½åŠ›ï¼Œæå‰å”åŠ©é¢è©¦å®˜ç¯©é™¤ä¸é©ä»»çš„å“¡å·¥ã€‚&lt;br&gt;
&lt;a class="link" href="https://www.ithome.com.tw/news/143000" target="_blank" rel="noopener"
&gt;æ–‡ç« å ±å°&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;ç›£æ§å‡ç´šï¼šäººè‡‰è­˜åˆ¥ç³»çµ±èƒ½è®€å‡ºæƒ…ç·’å’Œå¨è„…æ€§&lt;br&gt;
&lt;a class="link" href="https://www.bbc.com/zhongwen/trad/world-44859007" target="_blank" rel="noopener"
&gt;æ–‡ç« å ±å°&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;h2 id="åƒè€ƒå…§å®¹"&gt;åƒè€ƒå…§å®¹
&lt;/h2&gt;&lt;p&gt;æ·ºè«‡ç‚ºè¡¨æƒ…å¿ƒç†å­¸ï¼šhttps://www.thenewslens.com/article/128732&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Photo by &lt;a class="link" href="https://unsplash.com/@pawel_czerwinski" target="_blank" rel="noopener"
&gt;Pawel Czerwinski&lt;/a&gt; on &lt;a class="link" href="https://unsplash.com/" target="_blank" rel="noopener"
&gt;Unsplash&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;</description></item></channel></rss>